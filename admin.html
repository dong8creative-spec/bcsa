<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>관리자 대시보드 - 부산청년사업가</title>
    
    <!-- 폰트 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 다음 우편번호 서비스 + 카카오 맵 SDK (장소 선택용) -->
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=f35b8c9735d77cced1235c5775c7c3b1&libraries=services"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Noto Sans KR', 'sans-serif'],
                        pop: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        brand: '#0045a5', 
                        accent: '#3b82f6',
                        dark: '#0f172a',
                        gray: '#64748b',
                        soft: '#f8fafc',
                    },
                }
            }
        }
    </script>

    <style>
        body { background-color: #ffffff; color: #1e293b; font-family: 'Noto Sans KR', sans-serif; }
        .modal-scroll::-webkit-scrollbar { width: 6px; }
        .modal-scroll::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
        .modal-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .modal-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // ==========================================
        // 상수 및 설정
        // ==========================================
        const STORAGE_KEY_MEMBERS = 'busan_ycc_members';
        const STORAGE_KEY_SEMINARS = 'busan_ycc_seminars';
        const STORAGE_KEY_POSTS = 'busan_ycc_posts';
        const STORAGE_KEY_CONTENT = 'busan_ycc_content';
        const STORAGE_KEY_MENU_ENABLED = 'busan_ycc_menu_enabled';
        const STORAGE_KEY_MENU_NAMES = 'busan_ycc_menu_names';
        const STORAGE_KEY_ADMIN_LOGS = 'busan_ycc_admin_logs';
        const STORAGE_KEY_CURRENT_USER = 'busan_ycc_current_user';
        const STORAGE_KEY_CSV_URLS = 'busan_ycc_csv_urls';
        const IMGBB_API_KEY = '4c975214037cdf1889d5d02a01a7831d';
        
        // 카카오 Maps JavaScript 키
        const KAKAO_MAP_APP_KEY = 'f35b8c9735d77cced1235c5775c7c3b1';

        // ==========================================
        // 아이콘 컴포넌트
        // ==========================================
        const Icons = {
            Users: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
            Calendar: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>,
            Clock: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
            ChevronLeft: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="15 18 9 12 15 6"/></svg>,
            ChevronRight: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>,
            Restaurant: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3z"/><path d="M21 15v7"/></svg>,
            MessageSquare: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>,
            Settings: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>,
            Lock: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>,
            ArrowLeft: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>,
            X: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
            Plus: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>,
            Edit: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>,
            Trash: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>,
            FileText: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M10 9H8"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>,
            List: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></svg>,
            Download: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>,
            MapPin: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>,
        };
        
        // ==========================================
        // 유틸리티 함수
        // ==========================================
        const loadDataFromStorage = (key, defaultValue) => {
            try {
                const stored = localStorage.getItem(key);
                return stored ? JSON.parse(stored) : defaultValue;
            } catch (error) {
                console.error(`데이터 로드 오류 (${key}):`, error);
                return defaultValue;
            }
        };
        
        const saveDataToStorage = (key, data) => {
            try {
                localStorage.setItem(key, JSON.stringify(data));
            } catch (error) {
                console.error(`데이터 저장 오류 (${key}):`, error);
            }
        };
        
        const formatDate = (date) => {
            if (!date) return '';
            const d = new Date(date);
            return d.toLocaleDateString('ko-KR', { year: 'numeric', month: '2-digit', day: '2-digit' });
        };
        
        // 카카오 지도 모달 컴포넌트
        const KakaoMapModal = ({ onClose, onSelectLocation, initialLocation }) => {
            const mapContainerRef = React.useRef(null);
            const mapRef = React.useRef(null);
            const markerRef = React.useRef(null);
            const geocoderRef = React.useRef(null);
            const placesServiceRef = React.useRef(null);
            const [selectedPlace, setSelectedPlace] = useState(null);
            const [searchKeyword, setSearchKeyword] = useState('');
            const [searchResults, setSearchResults] = useState([]);
            const [mapLoaded, setMapLoaded] = useState(false);
            
            React.useEffect(() => {
                // 카카오 지도 SDK가 로드되었는지 확인
                if (typeof kakao === 'undefined' || !kakao.maps) {
                    console.error('카카오 지도 SDK가 로드되지 않았습니다. API 키를 확인해주세요.');
                    return;
                }
                
                // 지도 초기화
                const center = initialLocation 
                    ? new kakao.maps.LatLng(initialLocation.lat, initialLocation.lng)
                    : new kakao.maps.LatLng(35.1796, 129.0756); // 부산 중심
                
                const mapOption = {
                    center: center,
                    level: 3
                };
                
                mapRef.current = new kakao.maps.Map(mapContainerRef.current, mapOption);
                geocoderRef.current = new kakao.maps.services.Geocoder();
                
                // Places 서비스 초기화
                if (kakao.maps.services && kakao.maps.services.Places) {
                    placesServiceRef.current = new kakao.maps.services.Places();
                } else {
                    console.error('Places 서비스가 사용할 수 없습니다.');
                }
                
                // 지도 컨트롤 추가
                const zoomControl = new kakao.maps.ZoomControl();
                mapRef.current.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);
                
                // 초기 위치에 마커 표시
                if (initialLocation) {
                    markerRef.current = new kakao.maps.Marker({
                        position: center,
                        map: mapRef.current
                    });
                    setSelectedPlace({
                        name: initialLocation.name || '',
                        address: initialLocation.address || '',
                        lat: initialLocation.lat,
                        lng: initialLocation.lng
                    });
                }
                
                // 지도 클릭 이벤트
                kakao.maps.event.addListener(mapRef.current, 'click', (mouseEvent) => {
                    const latlng = mouseEvent.latLng;
                    
                    // 기존 마커 제거
                    if (markerRef.current) {
                        markerRef.current.setMap(null);
                    }
                    
                    // 새 마커 추가
                    markerRef.current = new kakao.maps.Marker({
                        position: latlng,
                        map: mapRef.current
                    });
                    
                    // 역지오코딩으로 주소 가져오기
                    geocoderRef.current.coord2Address(latlng.getLng(), latlng.getLat(), (result, status) => {
                        if (status === kakao.maps.services.Status.OK) {
                            const roadAddr = result[0].road_address;
                            const jibunAddr = result[0].address;
                            
                            setSelectedPlace({
                                name: '',
                                address: roadAddr ? roadAddr.address_name : jibunAddr.address_name,
                                lat: latlng.getLat(),
                                lng: latlng.getLng()
                            });
                        } else {
                            setSelectedPlace({
                                name: '',
                                address: `위도: ${latlng.getLat().toFixed(6)}, 경도: ${latlng.getLng().toFixed(6)}`,
                                lat: latlng.getLat(),
                                lng: latlng.getLng()
                            });
                        }
                    });
                });
                
                setMapLoaded(true);
            }, []);
            
            // 장소 검색
            const handleSearch = () => {
                if (!searchKeyword.trim()) {
                    alert('검색어를 입력해주세요.');
                    return;
                }
                
                if (!mapLoaded) {
                    alert('지도가 아직 로드되지 않았습니다. 잠시 후 다시 시도해주세요.');
                    return;
                }
                
                if (!placesServiceRef.current) {
                    console.error('Places 서비스가 초기화되지 않았습니다.');
                    alert('검색 서비스를 사용할 수 없습니다. 페이지를 새로고침해주세요.');
                    return;
                }
                
                setSearchResults([]); // 검색 결과 초기화
                
                // 키워드 검색
                placesServiceRef.current.keywordSearch(searchKeyword, (data, status) => {
                    if (status === kakao.maps.services.Status.OK) {
                        const results = data.map(place => ({
                            name: place.place_name,
                            address: place.road_address_name || place.address_name,
                            lat: parseFloat(place.y),
                            lng: parseFloat(place.x)
                        }));
                        setSearchResults(results);
                        
                        if (results.length === 0) {
                            alert('검색 결과가 없습니다.');
                        }
                    } else if (status === kakao.maps.services.Status.ZERO_RESULT) {
                        // 키워드 검색 실패 시 주소 검색 시도
                        if (geocoderRef.current) {
                            geocoderRef.current.addressSearch(searchKeyword, (result, geocodeStatus) => {
                                if (geocodeStatus === kakao.maps.services.Status.OK) {
                                    const results = result.map(item => ({
                                        name: '',
                                        address: item.road_address ? item.road_address.address_name : item.address_name,
                                        lat: parseFloat(item.y),
                                        lng: parseFloat(item.x)
                                    }));
                                    setSearchResults(results);
                                } else {
                                    alert('검색 결과가 없습니다.');
                                    setSearchResults([]);
                                }
                            });
                        } else {
                            alert('검색 결과가 없습니다.');
                        }
                    } else {
                        console.error('카카오맵 검색 오류:', status);
                        alert('검색 중 오류가 발생했습니다. 다시 시도해주세요.');
                    }
                });
            };
            
            // 검색 결과 선택
            const handleSelectResult = (result) => {
                const latlng = new kakao.maps.LatLng(result.lat, result.lng);
                
                mapRef.current.setCenter(latlng);
                mapRef.current.setLevel(3);
                
                // 기존 마커 제거
                if (markerRef.current) {
                    markerRef.current.setMap(null);
                }
                
                // 새 마커 추가
                markerRef.current = new kakao.maps.Marker({
                    position: latlng,
                    map: mapRef.current
                });
                
                setSelectedPlace({
                    name: result.name || '',
                    address: result.address,
                    lat: result.lat,
                    lng: result.lng
                });
                
                setSearchResults([]);
            };
            
            // 장소 확정
            const handleConfirm = () => {
                if (!selectedPlace) {
                    alert('지도에서 장소를 선택해주세요.');
                    return;
                }
                onSelectLocation(selectedPlace);
                onClose();
            };
            
            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70" onClick={(e) => e.target === e.currentTarget && onClose()}>
                    <div className="bg-white rounded-3xl p-6 max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col" onClick={(e) => e.stopPropagation()}>
                        <div className="flex items-center justify-between mb-4">
                            <h3 className="text-xl font-bold text-dark">장소 선택 (카카오 맵)</h3>
                            <button onClick={onClose} className="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                                <Icons.X size={20} />
                            </button>
                        </div>
                        
                        {/* 검색 */}
                        <div className="flex gap-2 mb-4">
                            <input
                                type="text"
                                value={searchKeyword}
                                onChange={(e) => setSearchKeyword(e.target.value)}
                                onKeyPress={(e) => e.key === 'Enter' && handleSearch()}
                                placeholder="주소 또는 장소명 검색"
                                className="flex-1 p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none"
                            />
                            <button
                                onClick={handleSearch}
                                className="px-4 py-3 bg-brand text-white rounded-xl font-bold hover:bg-blue-700 transition-colors"
                            >
                                검색
                            </button>
                        </div>
                        
                        {/* 검색 결과 */}
                        {searchResults.length > 0 && (
                            <div className="mb-4 max-h-40 overflow-y-auto border border-gray-200 rounded-xl">
                                {searchResults.map((result, idx) => (
                                    <div
                                        key={idx}
                                        onClick={() => handleSelectResult(result)}
                                        className="p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0"
                                    >
                                        {result.name && <p className="font-bold text-sm text-dark">{result.name}</p>}
                                        <p className="text-sm text-gray-600">{result.address}</p>
                                    </div>
                                ))}
                            </div>
                        )}
                        
                        {/* 지도 */}
                        <div 
                            ref={mapContainerRef} 
                            className="flex-1 min-h-[400px] rounded-xl border-2 border-gray-200 overflow-hidden"
                        />
                        
                        {/* 선택된 장소 정보 */}
                        {selectedPlace && (
                            <div className="mt-4 p-4 bg-yellow-50 border border-yellow-300 rounded-xl">
                                <p className="text-sm font-bold text-yellow-700 mb-1">선택된 장소</p>
                                {selectedPlace.name && <p className="font-bold text-sm text-dark">{selectedPlace.name}</p>}
                                <p className="text-sm text-gray-700">{selectedPlace.address}</p>
                                <p className="text-xs text-gray-500 mt-1">
                                    좌표: {selectedPlace.lat?.toFixed(6)}, {selectedPlace.lng?.toFixed(6)}
                                </p>
                            </div>
                        )}
                        
                        {/* 버튼 */}
                        <div className="flex gap-3 mt-4">
                            <button
                                onClick={onClose}
                                className="flex-1 py-3 border-2 border-gray-200 rounded-xl font-bold text-gray-600 hover:bg-gray-50 transition-colors"
                            >
                                취소
                            </button>
                            <button
                                onClick={handleConfirm}
                                disabled={!selectedPlace}
                                className={`flex-1 py-3 rounded-xl font-bold transition-colors ${
                                    selectedPlace 
                                        ? 'bg-brand text-white hover:bg-blue-700' 
                                        : 'bg-gray-200 text-gray-400 cursor-not-allowed'
                                }`}
                            >
                                선택 완료
                            </button>
                        </div>
                    </div>
                </div>
            );
        };
        
        // DateTimePicker 커스텀 컴포넌트
        const DateTimePicker = ({ value, onChange, placeholder }) => {
            const [showCalendar, setShowCalendar] = useState(false);
            const [currentMonth, setCurrentMonth] = useState(() => {
                if (value) {
                    const match = value.match(/(\d{4})\.(\d{2})\.(\d{2})/);
                    if (match) return new Date(parseInt(match[1]), parseInt(match[2]) - 1, 1);
                }
                return new Date();
            });
            const [selectedDate, setSelectedDate] = useState(() => {
                if (value) {
                    const match = value.match(/(\d{4})\.(\d{2})\.(\d{2})/);
                    if (match) return new Date(parseInt(match[1]), parseInt(match[2]) - 1, parseInt(match[3]));
                }
                return null;
            });
            const [selectedTime, setSelectedTime] = useState(() => {
                if (value) {
                    const timeMatch = value.match(/(\d{2}):(\d{2})/);
                    if (timeMatch) return `${timeMatch[1]}:${timeMatch[2]}`;
                }
                return '10:00';
            });
            const calendarRef = React.useRef(null);
            
            // 외부 클릭 시 달력 닫기
            React.useEffect(() => {
                const handleClickOutside = (event) => {
                    if (calendarRef.current && !calendarRef.current.contains(event.target)) {
                        setShowCalendar(false);
                    }
                };
                document.addEventListener('mousedown', handleClickOutside);
                return () => document.removeEventListener('mousedown', handleClickOutside);
            }, []);
            
            // 월의 일수 계산
            const getDaysInMonth = (year, month) => new Date(year, month + 1, 0).getDate();
            
            // 월의 첫 번째 요일
            const getFirstDayOfMonth = (year, month) => new Date(year, month, 1).getDay();
            
            // 달력 날짜 배열 생성
            const generateCalendarDays = () => {
                const year = currentMonth.getFullYear();
                const month = currentMonth.getMonth();
                const daysInMonth = getDaysInMonth(year, month);
                const firstDay = getFirstDayOfMonth(year, month);
                const days = [];
                
                // 빈 칸 (이전 달)
                for (let i = 0; i < firstDay; i++) {
                    days.push(null);
                }
                // 현재 달 날짜
                for (let day = 1; day <= daysInMonth; day++) {
                    days.push(new Date(year, month, day));
                }
                return days;
            };
            
            // 시간 옵션 생성 (30분 단위)
            const timeOptions = [];
            for (let h = 0; h < 24; h++) {
                for (let m = 0; m < 60; m += 30) {
                    const hour = h.toString().padStart(2, '0');
                    const minute = m.toString().padStart(2, '0');
                    timeOptions.push(`${hour}:${minute}`);
                }
            }
            
            // 날짜 선택
            const handleDateClick = (date) => {
                setSelectedDate(date);
            };
            
            // 선택 완료
            const handleConfirm = () => {
                if (selectedDate) {
                    const year = selectedDate.getFullYear();
                    const month = (selectedDate.getMonth() + 1).toString().padStart(2, '0');
                    const day = selectedDate.getDate().toString().padStart(2, '0');
                    const dateTimeStr = `${year}.${month}.${day} ${selectedTime}`;
                    onChange(dateTimeStr);
                    setShowCalendar(false);
                }
            };
            
            // 이전 달
            const prevMonth = () => {
                setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() - 1, 1));
            };
            
            // 다음 달
            const nextMonth = () => {
                setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 1));
            };
            
            // 오늘 날짜 체크
            const isToday = (date) => {
                if (!date) return false;
                const today = new Date();
                return date.getDate() === today.getDate() && 
                       date.getMonth() === today.getMonth() && 
                       date.getFullYear() === today.getFullYear();
            };
            
            // 선택된 날짜 체크
            const isSelected = (date) => {
                if (!date || !selectedDate) return false;
                return date.getDate() === selectedDate.getDate() && 
                       date.getMonth() === selectedDate.getMonth() && 
                       date.getFullYear() === selectedDate.getFullYear();
            };
            
            const weekDays = ['일', '월', '화', '수', '목', '금', '토'];
            
            return (
                <div className="relative" ref={calendarRef}>
                    <div 
                        className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none cursor-pointer flex items-center justify-between bg-white"
                        onClick={() => setShowCalendar(!showCalendar)}
                    >
                        <span className={value ? 'text-gray-900' : 'text-gray-400'}>
                            {value || placeholder || '날짜와 시간을 선택하세요'}
                        </span>
                        <Icons.Calendar size={20} className="text-gray-400" />
                    </div>
                    
                    {showCalendar && (
                        <div className="absolute top-full left-0 mt-2 bg-white border-2 border-gray-200 rounded-2xl shadow-xl z-50 p-4 w-80">
                            {/* 월 네비게이션 */}
                            <div className="flex items-center justify-between mb-4">
                                <button type="button" onClick={prevMonth} className="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                                    <Icons.ChevronLeft size={20} />
                                </button>
                                <span className="font-bold text-lg">
                                    {currentMonth.getFullYear()}년 {currentMonth.getMonth() + 1}월
                                </span>
                                <button type="button" onClick={nextMonth} className="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                                    <Icons.ChevronRight size={20} />
                                </button>
                            </div>
                            
                            {/* 요일 헤더 */}
                            <div className="grid grid-cols-7 gap-1 mb-2">
                                {weekDays.map((day, idx) => (
                                    <div key={day} className={`text-center text-sm font-bold py-2 ${idx === 0 ? 'text-red-500' : idx === 6 ? 'text-blue-500' : 'text-gray-600'}`}>
                                        {day}
                                    </div>
                                ))}
                            </div>
                            
                            {/* 날짜 그리드 */}
                            <div className="grid grid-cols-7 gap-1 mb-4">
                                {generateCalendarDays().map((date, idx) => (
                                    <button
                                        key={idx}
                                        type="button"
                                        disabled={!date}
                                        onClick={() => date && handleDateClick(date)}
                                        className={`
                                            w-9 h-9 rounded-lg text-sm font-medium transition-all
                                            ${!date ? 'invisible' : ''}
                                            ${date && isSelected(date) ? 'bg-brand text-white' : ''}
                                            ${date && isToday(date) && !isSelected(date) ? 'border-2 border-brand text-brand' : ''}
                                            ${date && !isSelected(date) && !isToday(date) ? 'hover:bg-gray-100' : ''}
                                            ${date && idx % 7 === 0 ? 'text-red-500' : ''}
                                            ${date && idx % 7 === 6 ? 'text-blue-500' : ''}
                                        `}
                                    >
                                        {date ? date.getDate() : ''}
                                    </button>
                                ))}
                            </div>
                            
                            {/* 시간 선택 */}
                            <div className="flex items-center gap-3 mb-4 pb-4 border-b border-gray-200">
                                <Icons.Clock size={18} className="text-gray-400" />
                                <span className="text-sm font-bold text-gray-700">시간:</span>
                                <select 
                                    value={selectedTime}
                                    onChange={(e) => setSelectedTime(e.target.value)}
                                    className="flex-1 p-2 border-2 border-gray-200 rounded-lg focus:border-brand focus:outline-none text-sm"
                                >
                                    {timeOptions.map(time => (
                                        <option key={time} value={time}>{time}</option>
                                    ))}
                                </select>
                            </div>
                            
                            {/* 선택 완료 버튼 */}
                            <button
                                type="button"
                                onClick={handleConfirm}
                                disabled={!selectedDate}
                                className={`w-full py-3 rounded-xl font-bold transition-colors ${
                                    selectedDate 
                                        ? 'bg-brand text-white hover:bg-blue-700' 
                                        : 'bg-gray-200 text-gray-400 cursor-not-allowed'
                                }`}
                            >
                                선택 완료
                            </button>
                        </div>
                    )}
                </div>
            );
        };
        
        // 파일을 Base64로 변환
        const fileToBase64 = (file) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onloadend = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        };
        
        // 이미지 리사이징
        const resizeImage = (file, maxWidth, maxHeight, quality = 0.9) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        let width = img.width;
                        let height = img.height;
                        
                        if (width > maxWidth || height > maxHeight) {
                            const ratio = Math.min(maxWidth / width, maxHeight / height);
                            width = width * ratio;
                            height = height * ratio;
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        canvas.toBlob((blob) => {
                            if (blob) {
                                const reader = new FileReader();
                                reader.onloadend = () => resolve(reader.result);
                                reader.onerror = reject;
                                reader.readAsDataURL(blob);
                            } else {
                                reject(new Error('이미지 리사이징 실패'));
                            }
                        }, file.type || 'image/png', quality);
                    };
                    img.onerror = reject;
                    img.src = e.target.result;
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        };
        
        // ImgBB 이미지 업로드
        const uploadImageToImgBB = async (base64Image, fileName) => {
            try {
                const base64Data = base64Image.split(',')[1] || base64Image;
                const formData = new FormData();
                formData.append('key', IMGBB_API_KEY);
                formData.append('image', base64Data);
                formData.append('name', fileName || 'image');

                const response = await fetch('https://api.imgbb.com/1/upload', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();
                if (data.success && data.data && data.data.url) {
                    return {
                        success: true,
                        url: data.data.url,
                        deleteUrl: data.data.delete_url || null,
                        id: data.data.id
                    };
                } else {
                    throw new Error(data.error?.message || data.error || '이미지 업로드 실패');
                }
            } catch (error) {
                console.error('ImgBB 업로드 오류:', error);
                throw error;
            }
        };

        // 이미지 다운로드
        const downloadImage = async (imageUrl, fileName) => {
            try {
                const response = await fetch(imageUrl);
                const blob = await response.blob();
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = fileName || 'image.jpg';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            } catch (error) {
                console.error('이미지 다운로드 오류:', error);
                alert('이미지 다운로드에 실패했습니다.');
            }
        };
        
        // 상태 계산 함수
        const calculateStatus = (dateString) => {
            if (!dateString) return "모집중";
            const seminarDate = new Date(dateString.replace(/\./g, '-'));
            const today = new Date();
            today.setHours(0,0,0,0);
            const diffTime = seminarDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            if (diffDays < 0) return "종료";
            if (diffDays <= 14) return "마감임박";
            return "모집중";
        };

        // ==========================================
        // 기본 데이터
        // ==========================================
        const defaultContent = {
            hero_title: "함께 성장하는\n청년 사업가 커뮤니티\n부산청년사업가들",
            hero_desc: "부산 지역 청년 사업가들이 모여 아이디어를 공유하고, 네트워킹하며 함께 성장해나가는 공간입니다.",
            // About 페이지 (소개 페이지)
            about_hero_title: "함께 성장하는 사업가 네트워크",
            about_hero_desc: "부산 지역 청년 사업가들의 성장과 연결을 돕는 비즈니스 커뮤니티, 부청사입니다.",
            about_mission_title: "Platform for Businessmen",
            about_mission_desc_1: "부산청년사업가들은 정기적인 네트워킹과 실무 중심의 세미나를 통해 실질적인 도움을 제공합니다.",
            about_mission_desc_2: "업종을 넘어선 협업과 정보 공유를 지원하며, 온·오프라인을 연계해 지속적인 비즈니스 확장을 돕습니다.",
            about_mission_desc_3: "부청사는 단순한 모임을 넘어, 함께 성장하는 플랫폼입니다.",
            about_why_title: "'부청사'가 필요한 이유",
            about_why_subtitle: "혼자 고민하지 마세요. 함께하면 답이 보입니다.",
            about_why_1_title: "고립감/압박감 해소",
            about_why_1_desc: "같은 길을 걷는 동료들과 고민을 나누는 심리적 안전망",
            about_why_2_title: "번아웃 방지",
            about_why_2_desc: "일과 삶의 균형을 찾고 리프레시할 수 있는 기회 제공",
            about_why_3_title: "성장의 한계 극복",
            about_why_3_desc: "다양한 경험 공유를 통해 새로운 인사이트와 협업 기회 획득",
            about_why_4_title: "네트워크 확장",
            about_why_4_desc: "투자자, 고객, 파트너를 만나 실질적인 비즈니스 기회 창출",
            about_history_title: "HISTORY",
            about_history_subtitle: "부산청년사업가들이 걸어온 길",
            about_history_2014_title: "지주회사 설립 기획",
            about_history_2014_desc: "부산청년사업가들 필요성 검토 및 기획",
            about_history_2017_title: "커뮤니티 구축",
            about_history_2017_desc: "회원간 소통 내부망 구축 및 카카오 오픈채팅방 개설",
            about_history_2018_title: "첫 오프라인 활동",
            about_history_2018_desc: "창업자들을 위한 첫 세미나 개최 및 네트워킹 모임 운영",
            about_history_2024_title: "정기 세미나 구축",
            about_history_2024_desc: "창업/세무/마케팅 교육 프로그램 및 정기 모임 활성화",
            about_history_2025_title: "비영리 법인 설립",
            about_history_2025_desc: "공식 단체 법인화 및 온라인 플랫폼(어플) 개발 추진",
            about_future_title: "향후 계획 및 목표",
            about_future_subtitle: "부청사는 멈추지 않고 계속 성장합니다.",
            about_future_1_title: "맞춤형 역량 교육",
            about_future_1_desc: "창업 단계별 실무 교육(세무, 마케팅 등)과 멘토링 강화",
            about_future_2_title: "공공사업 연계",
            about_future_2_desc: "정부·지자체 사업과 협력하여 실질적 혜택 제공",
            about_future_3_title: "온라인 플랫폼",
            about_future_3_desc: "회원들이 연결되고 협업할 수 있는 전용 앱/웹 구축",
            about_future_4_title: "사회공헌 활동",
            about_future_4_desc: "멘토링, 재능기부 등 지역사회와 상생하는 프로그램",
            about_future_5_title: "정책 제안",
            about_future_5_desc: "부산 청년 창업가 실태조사 기반 맞춤형 정책 제안",
            about_future_6_title: "자체 수익모델",
            about_future_6_desc: "교육 콘텐츠, 굿즈 등 지속가능한 운영 기반 마련",
            about_contact_phone: "010-5323-9310",
            about_contact_email: "pujar@naver.com",
        };

        const defaultMembersData = [];
        const defaultSeminarsData = [];
        const defaultCommunityPosts = [];

        // ==========================================
        // 관리자 대시보드 컴포넌트
        // ==========================================
        const AdminDashboard = () => {
            // 데이터 상태
            const [members, setMembers] = useState(() => loadDataFromStorage(STORAGE_KEY_MEMBERS, defaultMembersData));
            const [seminars, setSeminars] = useState(() => loadDataFromStorage(STORAGE_KEY_SEMINARS, defaultSeminarsData));
            const [posts, setPosts] = useState(() => loadDataFromStorage(STORAGE_KEY_POSTS, defaultCommunityPosts));
            const [content, setContent] = useState(() => loadDataFromStorage(STORAGE_KEY_CONTENT, defaultContent));
            const [menuEnabled, setMenuEnabled] = useState(() => {
                const stored = loadDataFromStorage(STORAGE_KEY_MENU_ENABLED, {});
                // index.html과 일치하는 기본값 설정
                return {
                    '홈': stored['홈'] !== undefined ? stored['홈'] : true,
                    '소개': stored['소개'] !== undefined ? stored['소개'] : true,
                    '프로그램': stored['프로그램'] !== undefined ? stored['프로그램'] : true,
                    '부청사 회원': stored['부청사 회원'] !== undefined ? stored['부청사 회원'] : true,
                    '커뮤니티': stored['커뮤니티'] !== undefined ? stored['커뮤니티'] : true,
                    '입찰공고': stored['입찰공고'] !== undefined ? stored['입찰공고'] : true,
                    '후원': stored['후원'] !== undefined ? stored['후원'] : true,
                    ...stored
                };
            });
            const [menuNames, setMenuNames] = useState(() => {
                const stored = loadDataFromStorage(STORAGE_KEY_MENU_NAMES, {});
                // index.html과 일치하는 기본값 설정
                return {
                    '홈': stored['홈'] || '홈',
                    '소개': stored['소개'] || '소개',
                    '프로그램': stored['프로그램'] || '프로그램',
                    '부청사 회원': stored['부청사 회원'] || '부청사 회원',
                    '커뮤니티': stored['커뮤니티'] || '커뮤니티',
                    '입찰공고': stored['입찰공고'] || '입찰공고',
                    '후원': stored['후원'] || '후원',
                    ...stored
                };
            });
            const [logs, setLogs] = useState(() => loadDataFromStorage(STORAGE_KEY_ADMIN_LOGS, []));
            const [currentUser] = useState(() => loadDataFromStorage(STORAGE_KEY_CURRENT_USER, null));
            
            // UI 상태
            const [activeTab, setActiveTab] = useState('members'); 
            const [isMaster, setIsMaster] = useState(false);
            const [showMasterLogin, setShowMasterLogin] = useState(false);
            const [masterPwInput, setMasterPwInput] = useState('');
            
            // 데이터 저장 (변경 시 자동)
            useEffect(() => {
                saveDataToStorage(STORAGE_KEY_MEMBERS, members);
            }, [members]);
            
            useEffect(() => {
                saveDataToStorage(STORAGE_KEY_SEMINARS, seminars);
            }, [seminars]);
            
            useEffect(() => {
                saveDataToStorage(STORAGE_KEY_POSTS, posts);
            }, [posts]);
            
            useEffect(() => {
                saveDataToStorage(STORAGE_KEY_CONTENT, content);
            }, [content]);
            
            // 로그 추가 함수
            const addLog = (action, targetType, details, adminName, itemInfo) => {
                const newLog = {
                    timestamp: new Date().toLocaleString('ko-KR'),
                    action,
                    targetType,
                    details,
                    adminName: adminName || currentUser?.name || '시스템',
                    itemInfo: itemInfo || '',
                };
                setLogs(prev => [...prev, newLog]);
                saveDataToStorage(STORAGE_KEY_ADMIN_LOGS, [...logs, newLog]);
            };
            
            // 마스터 로그인 핸들러
            const handleMasterLogin = () => {
                if (masterPwInput === '0219' || masterPwInput === '1122') {
                    setIsMaster(true);
                    setShowMasterLogin(false);
                    setMasterPwInput('');
                    addLog('MASTER_LOGIN', '시스템', '마스터 모드 로그인', currentUser?.name || '익명');
                    } else {
                    alert('비밀번호가 일치하지 않습니다.');
                }
            };
            
            // 탭 목록
            const tabs = [
                { id: 'members', label: '회원 관리', icon: Icons.Users },
                { id: 'seminars', label: '프로그램 관리', icon: Icons.Calendar },
                { id: 'community', label: '커뮤니티 관리', icon: Icons.MessageSquare },
                { id: 'master', label: 'admin', icon: Icons.Lock, masterOnly: true },
            ];

            return (
                <div className="min-h-screen bg-soft">
                    {/* 헤더 */}
                    <div className="bg-white border-b border-gray-200 sticky top-0 z-50">
                        <div className="container mx-auto px-4 py-4">
                            <div className="flex items-center justify-between">
                                <div>
                                    <h1 className="text-2xl font-bold text-dark">관리자 대시보드</h1>
                                    <p className="text-sm text-gray-500">사이트의 모든 콘텐츠를 관리할 수 있습니다.</p>
                                            </div>
                                                            <button
                                    onClick={() => window.location.href = 'index.html'}
                                    className="flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg font-bold text-gray-700 transition-colors"
                                >
                                    <Icons.ArrowLeft size={20} />
                                    메인으로
                                                            </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                    {/* 탭 네비게이션 */}
                    <div className="bg-white border-b border-gray-200">
                        <div className="container mx-auto px-4">
                            <div className="flex gap-1 overflow-x-auto hide-scrollbar">
                                {tabs.map(tab => {
                                    if (tab.masterOnly && !isMaster) {
                                                    return (
                                                            <button
                                                key={tab.id}
                                                onClick={() => setShowMasterLogin(true)}
                                                className="px-6 py-3 font-bold text-lg text-gray-400 hover:text-gray-600 transition-colors whitespace-nowrap flex items-center gap-2"
                                            >
                                                {React.createElement(tab.icon, { size: 20 })}
                                                {tab.label}
                                        </button>
                                                    );
                                                }
                                                return (
                                                            <button
                                            key={tab.id}
                                            onClick={() => setActiveTab(tab.id)}
                                            className={`px-6 py-3 font-bold text-lg transition-colors whitespace-nowrap flex items-center gap-2 relative ${
                                                activeTab === tab.id ? 'text-brand' : 'text-gray-400 hover:text-gray-600'
                                            }`}
                                        >
                                            {React.createElement(tab.icon, { size: 20 })}
                                            {tab.label}
                                            {activeTab === tab.id && (
                                                <div className="absolute bottom-0 left-0 w-full h-1 bg-brand rounded-t-full"></div>
                                            )}
                                                                        </button>
                                    );
                                })}
                                                        </div>
                                                        </div>
                                                        </div>
                    
                    {/* 콘텐츠 영역 */}
                    <div className="container mx-auto px-4 py-8">
                        <div className="bg-white rounded-3xl shadow-lg p-6 min-h-[500px]">
                            {activeTab === 'members' && (
                                <MembersTab members={members} setMembers={setMembers} addLog={addLog} currentUser={currentUser} />
                            )}
                            {activeTab === 'seminars' && (
                                <SeminarsTab seminars={seminars} setSeminars={setSeminars} addLog={addLog} currentUser={currentUser} />
                            )}
                            {activeTab === 'community' && (
                                <CommunityTab posts={posts} setPosts={setPosts} addLog={addLog} currentUser={currentUser} />
                            )}
                            {activeTab === 'master' && isMaster && (
                                <MasterTab
                                    content={content}
                                    setContent={setContent}
                                    menuEnabled={menuEnabled}
                                    setMenuEnabled={setMenuEnabled}
                                    menuNames={menuNames}
                                    setMenuNames={setMenuNames}
                                    logs={logs}
                                    addLog={addLog}
                                    currentUser={currentUser}
                                />
                            )}
                            {activeTab === 'master' && !isMaster && (
                                <div className="text-center py-20">
                                    <Icons.Lock size={48} className="mx-auto text-gray-400 mb-4" />
                                    <p className="text-gray-500">마스터 모드 로그인이 필요합니다.</p>
                                </div>
                            )}
                                    </div>
                                                    </div>
                    
                    {/* 마스터 로그인 모달 */}
                    {showMasterLogin && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70">
                            <div className="bg-white rounded-3xl p-8 max-w-md w-full">
                                <div className="text-center mb-6">
                                    <Icons.Lock size={48} className="mx-auto text-gray-800 mb-4" />
                                    <h3 className="text-2xl font-bold text-dark mb-2">마스터 모드</h3>
                                    <p className="text-sm text-gray-600">관리자 전용 기능입니다.<br/>비밀 코드를 입력하세요.</p>
                                                </div>
                                                        <input
                                    type="password"
                                    className="w-full p-4 border-2 border-gray-200 rounded-2xl text-center font-bold mb-6 focus:border-gray-800 focus:outline-none"
                                    value={masterPwInput}
                                    onChange={(e) => {
                                        const value = e.target.value;
                                        setMasterPwInput(value);
                                        // 비밀번호가 일치하면 자동으로 로그인
                                        if (value === '0219' || value === '1122') {
                                            setIsMaster(true);
                                            setShowMasterLogin(false);
                                            setMasterPwInput('');
                                            addLog('MASTER_LOGIN', '시스템', '마스터 모드 로그인', currentUser?.name || '익명');
                                        }
                                    }}
                                    placeholder="Master Code"
                                    onKeyPress={(e) => e.key === 'Enter' && handleMasterLogin()}
                                    autoFocus
                                />
                                <div className="flex gap-4">
                                                        <button
                                        onClick={() => { setShowMasterLogin(false); setMasterPwInput(''); }}
                                        className="flex-1 py-4 bg-gray-100 text-gray-700 font-bold rounded-2xl hover:bg-gray-200 transition-colors"
                                                        >
                                        취소
                                                        </button>
                                                                    <button
                                        onClick={handleMasterLogin}
                                        className="flex-1 py-4 bg-gray-800 text-white font-bold rounded-2xl hover:bg-gray-900 transition-colors"
                                                                    >
                                        확인
                                                                    </button>
                                                        </div>
                                    </div>
                                            </div>
                    )}
                </div>
            );
        };

        // ==========================================
        // 각 탭 컴포넌트
        // ==========================================
        const MembersTab = ({ members, setMembers, addLog, currentUser }) => {
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [editingItem, setEditingItem] = useState(null);
            const [formData, setFormData] = useState({ name: '', industry: '', role: '', company: '', img: '', memberGrade: '일반회원', approvalStatus: 'approved', isAdmin: false });
            
            const handleOpenModal = (item = null) => {
                if (item) {
                    setEditingItem(item);
                    setFormData(item);
                } else {
                    setEditingItem(null);
                    setFormData({ name: '', industry: '', role: '', company: '', img: '', memberGrade: '일반회원', approvalStatus: 'approved', isAdmin: false });
                }
                setIsModalOpen(true);
            };
            
            const handleCloseModal = () => {
                setIsModalOpen(false);
                setEditingItem(null);
                setFormData({ name: '', industry: '', role: '', company: '', img: '', memberGrade: '일반회원', approvalStatus: 'approved', isAdmin: false });
            };
            
            const handleSubmit = () => {
                if (!formData.name || !formData.company) {
                    alert('이름과 회사명은 필수입니다.');
                    return;
                }
                
                if (editingItem) {
                    const updated = members.map(m => m.id === editingItem.id ? { ...formData, id: editingItem.id } : m);
                    setMembers(updated);
                    addLog('UPDATE', '회원', `${currentUser?.name || '관리자'}님이 회원 정보를 수정했습니다.`, currentUser?.name, `회원: ${formData.name}`);
                } else {
                    const newMember = { ...formData, id: Date.now() };
                    setMembers([...members, newMember]);
                    addLog('CREATE', '회원', `${currentUser?.name || '관리자'}님이 회원을 추가했습니다.`, currentUser?.name, `회원: ${formData.name}`);
                }
                handleCloseModal();
            };
            
            const handleDelete = (id) => {
                if (confirm('정말 삭제하시겠습니까?')) {
                    const member = members.find(m => m.id === id);
                    setMembers(members.filter(m => m.id !== id));
                    addLog('DELETE', '회원', `${currentUser?.name || '관리자'}님이 회원을 삭제했습니다.`, currentUser?.name, `회원: ${member?.name || ''}`);
                }
            };
            
            return (
                <div>
                    <div className="flex items-center justify-between mb-6">
                        <h2 className="text-2xl font-bold text-dark">회원 관리</h2>
                        <button onClick={() => handleOpenModal()} className="flex items-center gap-2 px-4 py-2 bg-brand text-white rounded-lg font-bold hover:bg-blue-700 transition-colors">
                            <Icons.Plus size={20} />
                            회원 추가
                                                                            </button>
                                                                        </div>
                    
                    <div className="bg-white rounded-2xl border border-gray-200 overflow-hidden">
                        {members.length === 0 ? (
                            <div className="p-10 text-center text-gray-400">등록된 회원이 없습니다.</div>
                        ) : (
                            <table className="w-full">
                                <thead className="bg-gray-50 border-b border-gray-200">
                                    <tr>
                                        <th className="p-4 text-left text-sm font-bold text-gray-700">이름</th>
                                        <th className="p-4 text-left text-sm font-bold text-gray-700">회사명</th>
                                        <th className="p-4 text-left text-sm font-bold text-gray-700">업종</th>
                                        <th className="p-4 text-left text-sm font-bold text-gray-700">등급</th>
                                        <th className="p-4 text-left text-sm font-bold text-gray-700">상태</th>
                                        <th className="p-4 text-center text-sm font-bold text-gray-700">작업</th>
                                                                        </tr>
                                                                    </thead>
                                <tbody>
                                    {members.map((member, idx) => (
                                        <tr key={member.id || idx} className="border-b border-gray-100 hover:bg-gray-50">
                                            <td className="p-4">
                                                <div className="flex items-center gap-3">
                                                    <img src={member.img || `https://ui-avatars.com/api/?name=${member.name}&background=random`} alt={member.name} className="w-10 h-10 rounded-full object-cover" />
                                                    <span className="font-bold text-dark">{member.name}</span>
                                                </div>
                                                                                </td>
                                            <td className="p-4 text-gray-700">{member.company}</td>
                                            <td className="p-4 text-gray-600">{member.industry}</td>
                                                                                <td className="p-4">
                                                <span className={`text-xs px-2 py-1 rounded font-bold ${
                                                    member.memberGrade === '파트너사' ? 'bg-purple-100 text-purple-700' :
                                                    member.memberGrade === '운영진' ? 'bg-blue-100 text-blue-700' :
                                                                                            'bg-gray-100 text-gray-700'
                                                                                        }`}>
                                                    {member.memberGrade || '일반회원'}
                                                                    </span>
                                                                                </td>
                                                                                <td className="p-4">
                                                <span className={`text-xs px-2 py-1 rounded font-bold ${
                                                    member.approvalStatus === 'approved' ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'
                                                }`}>
                                                    {member.approvalStatus === 'approved' ? '승인됨' : '대기중'}
                                                </span>
                                                                                </td>
                                            <td className="p-4">
                                                <div className="flex items-center justify-center gap-2">
                                                    <button onClick={() => handleOpenModal(member)} className="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
                                                        <Icons.Edit size={18} />
                                                                                        </button>
                                                    <button onClick={() => handleDelete(member.id)} className="p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors">
                                                        <Icons.Trash size={18} />
                                                                    </button>
                                                                </div>
                                                                                </td>
                                                                            </tr>
                                                        ))}
                                                                    </tbody>
                                                                </table>
                                                )}
                                            </div>
                    
                    {/* 모달 */}
                    {isModalOpen && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70" onClick={(e) => e.target === e.currentTarget && handleCloseModal()}>
                            <div className="bg-white rounded-3xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto modal-scroll" onClick={(e) => e.stopPropagation()}>
                                <div className="flex items-center justify-between mb-6">
                                    <h3 className="text-2xl font-bold text-dark">{editingItem ? '회원 수정' : '회원 추가'}</h3>
                                    <button onClick={handleCloseModal} className="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                                        <Icons.X size={24} />
                                                            </button>
                                                        </div>
                                
                                            <div className="space-y-4">
                                                <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">이름 *</label>
                                        <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.name} onChange={(e) => setFormData({...formData, name: e.target.value})} />
                                                        </div>
                                                                    <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">회사명 *</label>
                                        <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.company} onChange={(e) => setFormData({...formData, company: e.target.value})} />
                                                                    </div>
                                            <div className="grid grid-cols-2 gap-4">
                                                                    <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">업종</label>
                                            <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.industry} onChange={(e) => setFormData({...formData, industry: e.target.value})} />
                                                                    </div>
                                                                    <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">직책</label>
                                            <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.role} onChange={(e) => setFormData({...formData, role: e.target.value})} />
                                                                    </div>
                                                                    </div>
                                                <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">프로필 이미지</label>
                                        <div className="flex gap-2 mb-2">
                                            <input type="text" className="flex-1 p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.img} onChange={(e) => setFormData({...formData, img: e.target.value})} placeholder="이미지 URL 입력 또는 파일 업로드" />
                                            <label className="px-4 py-3 bg-brand text-white rounded-xl cursor-pointer hover:bg-blue-700 transition-colors flex items-center gap-2 whitespace-nowrap">
                                                <Icons.Plus size={16} /> 파일
                                                <input type="file" accept="image/*" className="hidden" onChange={async (e) => {
                                                    const file = e.target.files[0];
                                                    if (!file) return;
                                                    try {
                                                        const reader = new FileReader();
                                                        reader.onload = async (event) => {
                                                            const base64 = event.target.result.split(',')[1];
                                                            const uploadFormData = new FormData();
                                                            uploadFormData.append('key', IMGBB_API_KEY);
                                                            uploadFormData.append('image', base64);
                                                            const response = await fetch('https://api.imgbb.com/1/upload', { method: 'POST', body: uploadFormData });
                                                            const data = await response.json();
                                                            if (data.success) {
                                                                setFormData({...formData, img: data.data.url});
                                                            } else {
                                                                alert('이미지 업로드에 실패했습니다.');
                                                            }
                                                        };
                                                        reader.readAsDataURL(file);
                                                    } catch (error) {
                                                        console.error('이미지 업로드 오류:', error);
                                                        alert('이미지 업로드에 실패했습니다.');
                                                    }
                                                }} />
                                            </label>
                                        </div>
                                        {formData.img && (
                                            <div className="mt-2 relative inline-block">
                                                <img src={formData.img} alt="미리보기" className="w-20 h-20 object-cover rounded-full border-2 border-gray-200" />
                                                <button type="button" onClick={() => setFormData({...formData, img: ''})} className="absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600">
                                                    <Icons.X size={10} />
                                                </button>
                                            </div>
                                        )}
                                                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                                <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">회원 등급</label>
                                            <select className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.memberGrade} onChange={(e) => setFormData({...formData, memberGrade: e.target.value})}>
                                                <option value="일반회원">일반회원</option>
                                                <option value="운영진">운영진</option>
                                                <option value="파트너사">파트너사</option>
                                            </select>
                                                                </div>
                                                <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">승인 상태</label>
                                            <select className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.approvalStatus} onChange={(e) => setFormData({...formData, approvalStatus: e.target.value})}>
                                                <option value="approved">승인됨</option>
                                                <option value="pending">대기중</option>
                                            </select>
                                                                        </div>
                                                                    </div>
                                                <div>
                                        <label className="flex items-center gap-2">
                                            <input type="checkbox" checked={formData.isAdmin || false} onChange={(e) => setFormData({...formData, isAdmin: e.target.checked})} />
                                            <span className="text-sm font-bold text-gray-700">관리자 권한</span>
                                        </label>
                                                                    </div>
                                                                    </div>
                                
                                <div className="flex gap-4 mt-8">
                                    <button onClick={handleCloseModal} className="flex-1 py-4 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition-colors">
                                        취소
                                                                        </button>
                                    <button onClick={handleSubmit} className="flex-1 py-4 bg-brand text-white font-bold rounded-xl hover:bg-blue-700 transition-colors">
                                        {editingItem ? '수정' : '추가'}
                                                                        </button>
                                                                    </div>
                                                                </div>
                                        </div>
                                    )}
                                </div>
            );
        };
        
        const SeminarsTab = ({ seminars, setSeminars, addLog, currentUser }) => {
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [editingItem, setEditingItem] = useState(null);
            const [formData, setFormData] = useState({ title: '', category: '교육/세미나', date: '', location: '', locationAddress: '', locationLat: null, locationLng: null, desc: '', images: [], price: 0, requiresPayment: false, maxParticipants: 50, currentParticipants: 0 });
            const [selectedSeminarForApplications, setSelectedSeminarForApplications] = useState(null);
            const [applications, setApplications] = useState([]);
            const [showMapModal, setShowMapModal] = useState(false); // 지도 모달 상태
            
            // 세미나 신청 정보 로드 및 업데이트
            useEffect(() => {
                const loadSeminarApplications = () => {
                    try {
                        const stored = localStorage.getItem('busan_ycc_seminar_applications');
                        return stored ? JSON.parse(stored) : [];
                                                                } catch (error) {
                        console.error('세미나 신청 정보 로드 오류:', error);
                        return [];
                    }
                };
                setApplications(loadSeminarApplications());
                
                // 주기적으로 업데이트 (2초마다)
                const interval = setInterval(() => {
                    setApplications(loadSeminarApplications());
                }, 2000);
                
                return () => clearInterval(interval);
            }, []);
            
            const handleOpenModal = (item = null) => {
                if (item) {
                    setEditingItem(item);
                    // 기존 데이터 호환성: img 필드를 images 배열로 변환
                    const images = item.images || (item.img ? [item.img] : []);
                    setFormData({...item, images});
                } else {
                    setEditingItem(null);
                    setFormData({ title: '', category: '교육/세미나', date: '', location: '', locationAddress: '', locationLat: null, locationLng: null, desc: '', images: [], price: 0, requiresPayment: false, maxParticipants: 50, currentParticipants: 0 });
                }
                setIsModalOpen(true);
            };
            
            const handleCloseModal = () => {
                setIsModalOpen(false);
                setEditingItem(null);
            };
            
            const handleSubmit = () => {
                if (!formData.title || !formData.date) {
                    alert('제목과 날짜는 필수입니다.');
                                                                    return;
                                                                }
                
                const status = calculateStatus(formData.date);
                // 기존 코드 호환성: images 배열의 첫 번째 이미지를 img 필드로도 저장
                const img = (formData.images && formData.images.length > 0) ? formData.images[0] : '';
                const seminarData = { ...formData, status, img };
                
                if (editingItem) {
                    const updated = seminars.map(s => s.id === editingItem.id ? { ...seminarData, id: editingItem.id } : s);
                    setSeminars(updated);
                    addLog('UPDATE', '프로그램', `${currentUser?.name || '관리자'}님이 프로그램을 수정했습니다.`, currentUser?.name, `프로그램: ${formData.title}`);
                } else {
                    const newSeminar = { ...seminarData, id: Date.now() };
                    setSeminars([...seminars, newSeminar]);
                    addLog('CREATE', '프로그램', `${currentUser?.name || '관리자'}님이 프로그램을 추가했습니다.`, currentUser?.name, `프로그램: ${formData.title}`);
                }
                handleCloseModal();
            };
            
            const handleDelete = (id) => {
                if (confirm('정말 삭제하시겠습니까?')) {
                    const seminar = seminars.find(s => s.id === id);
                    setSeminars(seminars.filter(s => s.id !== id));
                    addLog('DELETE', '프로그램', `${currentUser?.name || '관리자'}님이 프로그램을 삭제했습니다.`, currentUser?.name, `프로그램: ${seminar?.title || ''}`);
                }
            };
            
            return (
                                                <div>
                    <div className="flex items-center justify-between mb-6">
                        <h2 className="text-2xl font-bold text-dark">프로그램 관리</h2>
                        <button onClick={() => handleOpenModal()} className="flex items-center gap-2 px-4 py-2 bg-brand text-white rounded-lg font-bold hover:bg-blue-700 transition-colors">
                            <Icons.Plus size={20} />
                            프로그램 추가
                        </button>
                                                </div>

                    <div className="bg-white rounded-2xl border border-gray-200 overflow-hidden">
                        {seminars.length === 0 ? (
                            <div className="p-10 text-center text-gray-400">등록된 프로그램이 없습니다.</div>
                        ) : (
                            <table className="w-full">
                                <thead className="bg-gray-50 border-b border-gray-200">
                                    <tr>
                                        <th className="p-4 text-left text-sm font-bold text-gray-700">제목</th>
                                        <th className="p-4 text-left text-sm font-bold text-gray-700">카테고리</th>
                                        <th className="p-4 text-left text-sm font-bold text-gray-700">날짜</th>
                                        <th className="p-4 text-left text-sm font-bold text-gray-700">상태</th>
                                        <th className="p-4 text-center text-sm font-bold text-gray-700">신청자</th>
                                        <th className="p-4 text-center text-sm font-bold text-gray-700">작업</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {seminars.map((seminar, idx) => {
                                        const seminarApplications = applications.filter(app => app.seminarId === seminar.id);
                                        return (
                                            <tr key={seminar.id || idx} className="border-b border-gray-100 hover:bg-gray-50">
                                                <td className="p-4 font-bold text-dark">{seminar.title}</td>
                                                <td className="p-4 text-gray-600">{seminar.category}</td>
                                                <td className="p-4 text-gray-600">{seminar.date}</td>
                                                <td className="p-4">
                                                    <span className={`text-xs px-2 py-1 rounded font-bold ${
                                                        seminar.status === '종료' ? 'bg-gray-100 text-gray-700' :
                                                        seminar.status === '마감임박' ? 'bg-red-100 text-red-700' :
                                                        'bg-green-100 text-green-700'
                                                    }`}>
                                                        {seminar.status}
                                                    </span>
                                                </td>
                                                <td className="p-4 text-center">
                                                                <button 
                                                        onClick={() => setSelectedSeminarForApplications(seminar)}
                                                        className="text-brand font-bold hover:underline"
                                                    >
                                                        {seminarApplications.length}명
                                                    </button>
                                                </td>
                                                <td className="p-4">
                                                    <div className="flex items-center justify-center gap-2">
                                                        <button onClick={() => handleOpenModal(seminar)} className="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
                                                            <Icons.Edit size={18} />
                                                        </button>
                                                        <button onClick={() => handleDelete(seminar.id)} className="p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors">
                                                            <Icons.Trash size={18} />
                                                                </button>
                                                            </div>
                                                </td>
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        )}
                                        </div>
                                        
                    {/* 신청 정보 모달 */}
                    {selectedSeminarForApplications && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70" onClick={(e) => e.target === e.currentTarget && setSelectedSeminarForApplications(null)}>
                            <div className="bg-white rounded-3xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto modal-scroll" onClick={(e) => e.stopPropagation()}>
                                <div className="flex items-center justify-between mb-6">
                                    <h3 className="text-2xl font-bold text-dark">{selectedSeminarForApplications.title} - 신청자 목록</h3>
                                    <button onClick={() => setSelectedSeminarForApplications(null)} className="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                                        <Icons.X size={24} />
                                    </button>
                                                </div>
                                {(() => {
                                    const seminarApps = applications.filter(app => app.seminarId === selectedSeminarForApplications.id);
                                    if (seminarApps.length === 0) {
                                        return <div className="text-center py-10 text-gray-400">신청자가 없습니다.</div>;
                                    }
                                    return (
                                        <div className="space-y-4">
                                            {seminarApps.map((app, idx) => (
                                                <div key={idx} className="border border-gray-200 rounded-xl p-6 bg-gray-50">
                                                    <div className="flex items-start justify-between mb-4">
                                                <div>
                                                            <h4 className="font-bold text-dark text-lg mb-1">{app.userName}</h4>
                                                            <p className="text-sm text-gray-600">{app.userEmail}</p>
                                                            <p className="text-xs text-gray-500 mt-1">신청일: {new Date(app.appliedAt).toLocaleString('ko-KR')}</p>
                                                </div>
                                                        <span className={`text-xs px-3 py-1 rounded font-bold ${
                                                            app.status === 'approved' ? 'bg-green-100 text-green-700' :
                                                            app.status === 'rejected' ? 'bg-red-100 text-red-700' :
                                                            'bg-yellow-100 text-yellow-700'
                                                        }`}>
                                                            {app.status === 'approved' ? '승인' : app.status === 'rejected' ? '거부' : '대기중'}
                                                        </span>
                                                </div>
                                                    <div className="space-y-3">
                                                <div>
                                                            <h5 className="font-bold text-gray-700 mb-2">신청사유</h5>
                                                            <p className="text-sm text-gray-600 bg-white p-3 rounded-lg border border-gray-200">{app.applicationReason}</p>
                                                </div>
                                                <div>
                                                            <h5 className="font-bold text-gray-700 mb-2">사전질문</h5>
                                                            <div className="space-y-2 bg-white p-3 rounded-lg border border-gray-200">
                                                                {app.questions.map((q, qIdx) => (
                                                                    <div key={qIdx} className="text-sm text-gray-600">
                                                                        <span className="font-bold text-gray-700">Q{qIdx + 1}.</span> {q}
                                                </div>
                                                                ))}
                                                </div>
                                                </div>
                                                </div>
                                            </div>
                                            ))}
                                                        </div>
                                    );
                                })()}
                                                            </div>
                                                        </div>
                                                    )}
                                        
                    {/* 모달 */}
                    {isModalOpen && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70" onClick={(e) => e.target === e.currentTarget && handleCloseModal()}>
                            <div className="bg-white rounded-3xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto modal-scroll" onClick={(e) => e.stopPropagation()}>
                                <div className="flex items-center justify-between mb-6">
                                    <h3 className="text-2xl font-bold text-dark">{editingItem ? '프로그램 수정' : '프로그램 추가'}</h3>
                                    <button onClick={handleCloseModal} className="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                                        <Icons.X size={24} />
                                                            </button>
                                        </div>

                                            <div className="space-y-4">
                                                <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">제목 *</label>
                                        <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.title} onChange={(e) => setFormData({...formData, title: e.target.value})} />
                                                </div>
                                    <div className="grid grid-cols-2 gap-4">
                                                <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">카테고리</label>
                                            <select className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.category} onChange={(e) => setFormData({...formData, category: e.target.value})}>
                                                    <option value="교육/세미나">교육/세미나</option>
                                                    <option value="투자/IR">투자/IR</option>
                                                <option value="네트워킹/모임">네트워킹/모임</option>
                                                </select>
                                                </div>
                                                <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">일시 *</label>
                                            <DateTimePicker 
                                                value={formData.date} 
                                                onChange={(val) => setFormData({...formData, date: val})} 
                                                placeholder="날짜와 시간을 선택하세요"
                                            />
                                                </div>
                                                    </div>
                                                    <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">장소</label>
                                        <div className="flex gap-2">
                                            <input type="text" className="flex-1 p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.location} onChange={(e) => setFormData({...formData, location: e.target.value})} placeholder="장소명 또는 주소 입력" />
                                            <button type="button" onClick={() => setShowMapModal(true)} className="px-4 py-3 bg-green-600 text-white rounded-xl font-bold hover:bg-green-700 transition-colors flex items-center gap-2 whitespace-nowrap">
                                                <Icons.MapPin size={16} /> 지도 선택
                                            </button>
                                        </div>
                                        {formData.locationAddress && (
                                            <div className="mt-2 p-3 bg-green-50 border border-green-200 rounded-xl">
                                                <p className="text-xs text-green-700">{formData.locationAddress}</p>
                                                {formData.locationLat && formData.locationLng && (
                                                    <p className="text-xs text-gray-500 mt-1">좌표: {formData.locationLat.toFixed(6)}, {formData.locationLng.toFixed(6)}</p>
                                                )}
                                            </div>
                                        )}
                                                    </div>
                                                    <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">설명</label>
                                        <textarea className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-24 resize-none" value={formData.desc} onChange={(e) => setFormData({...formData, desc: e.target.value})} />
                                                </div>
                                                <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">프로그램 이미지 (최대 3장, 첫 번째 이미지가 대표 이미지)</label>
                                        <div className="flex gap-4 flex-wrap">
                                            {(formData.images || []).map((img, idx) => (
                                                <div key={idx} className="relative">
                                                    <img src={img} alt={`프로그램 이미지 ${idx + 1}`} className="w-24 h-32 object-cover rounded-xl border-2 border-gray-200" style={{ aspectRatio: '3/4' }} />
                                                    <button type="button" onClick={() => setFormData({...formData, images: formData.images.filter((_, i) => i !== idx)})} className="absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600">
                                                        <Icons.X size={12} />
                                                    </button>
                                                    {idx === 0 && <span className="absolute bottom-1 left-1 text-[10px] bg-brand text-white px-1.5 py-0.5 rounded">대표</span>}
                                                </div>
                                            ))}
                                            {(formData.images || []).length < 3 && (
                                                <label className="w-24 h-32 border-2 border-dashed border-gray-300 rounded-xl flex flex-col items-center justify-center cursor-pointer hover:border-brand transition-colors" style={{ aspectRatio: '3/4' }}>
                                                    <Icons.Plus size={24} className="text-gray-400 mb-1" />
                                                    <span className="text-xs text-gray-500">사진 추가</span>
                                                    <input type="file" accept="image/*" className="hidden" onChange={async (e) => {
                                                        const file = e.target.files[0];
                                                        if (!file) return;
                                                        try {
                                                            const reader = new FileReader();
                                                            reader.onload = async (event) => {
                                                                const base64 = event.target.result.split(',')[1];
                                                                const uploadFormData = new FormData();
                                                                uploadFormData.append('key', IMGBB_API_KEY);
                                                                uploadFormData.append('image', base64);
                                                                const response = await fetch('https://api.imgbb.com/1/upload', { method: 'POST', body: uploadFormData });
                                                                const data = await response.json();
                                                                if (data.success) {
                                                                    setFormData({...formData, images: [...(formData.images || []), data.data.url]});
                                                                } else {
                                                                    alert('이미지 업로드에 실패했습니다.');
                                                                }
                                                            };
                                                            reader.readAsDataURL(file);
                                                        } catch (error) {
                                                            console.error('이미지 업로드 오류:', error);
                                                            alert('이미지 업로드에 실패했습니다.');
                                                        }
                                                        e.target.value = '';
                                                    }} />
                                                </label>
                                            )}
                                        </div>
                                                </div>
                                    <div className="grid grid-cols-3 gap-4">
                                                <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">가격</label>
                                            <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.price} onChange={(e) => setFormData({...formData, price: parseInt(e.target.value) || 0})} />
                                                </div>
                                                <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">최대 인원</label>
                                            <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.maxParticipants} onChange={(e) => setFormData({...formData, maxParticipants: parseInt(e.target.value) || 0})} />
                                                </div>
                                                <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">현재 인원</label>
                                            <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.currentParticipants} onChange={(e) => setFormData({...formData, currentParticipants: parseInt(e.target.value) || 0})} />
                                                </div>
                                            </div>
                                                <div>
                                        <label className="flex items-center gap-2">
                                            <input type="checkbox" checked={formData.requiresPayment || false} onChange={(e) => setFormData({...formData, requiresPayment: e.target.checked})} />
                                            <span className="text-sm font-bold text-gray-700">결제 필요</span>
                                        </label>
                                                </div>
                                                </div>

                                <div className="flex gap-4 mt-8">
                                    <button onClick={handleCloseModal} className="flex-1 py-4 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition-colors">
                                        취소
                                    </button>
                                    <button onClick={handleSubmit} className="flex-1 py-4 bg-brand text-white font-bold rounded-xl hover:bg-blue-700 transition-colors">
                                        {editingItem ? '수정' : '추가'}
                                                                </button>
                                                            </div>
                                                                </div>
                                                            </div>
                                                        )}
                                                        
                                    {/* 카카오 지도 모달 */}
                                    {showMapModal && (
                                        <KakaoMapModal
                                            onClose={() => setShowMapModal(false)}
                                            onSelectLocation={(place) => {
                                                setFormData({
                                                    ...formData,
                                                    location: place.name || place.address,
                                                    locationAddress: place.address,
                                                    locationLat: place.lat,
                                                    locationLng: place.lng
                                                });
                                            }}
                                            initialLocation={formData.locationLat && formData.locationLng ? {
                                                lat: formData.locationLat,
                                                lng: formData.locationLng,
                                                address: formData.locationAddress,
                                                name: formData.location
                                            } : null}
                                        />
                                    )}
                                                    </div>
            );
        };

        const CommunityTab = ({ posts, setPosts, addLog, currentUser }) => {
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [editingItem, setEditingItem] = useState(null);
            const [uploadingImages, setUploadingImages] = useState(false);
            const [formData, setFormData] = useState({ 
                category: '공지사항', 
                title: '', 
                content: '', 
                author: '', 
                isSecret: false, 
                password: '',
                // 인력구인 필드
                jobDetails: '',
                recruitCount: '',
                workHours: '',
                salary: '',
                preferred: '',
                deadline: '',
                storeLocation: '',
                storePhone: '',
                storeImages: [],
                    // 중고거래 필드
                itemName: '',
                itemCategory: '',
                price: '',
                itemCondition: '',
                tradeMethod: '',
                tradeLocation: '',
                itemImages: [],
                businessNumber: '',
                // 프로그램 후기 필드
                rating: 0,
                reviewImages: [],
                seminarTitle: null
            });
            const [selectedCategory, setSelectedCategory] = useState('전체');
            
            const categories = ['전체', '공지사항', '인력구인', '프로그램 후기', '건의사항', '중고거래'];
            const filteredPosts = selectedCategory === '전체' ? posts : posts.filter(p => p.category === selectedCategory);
            
            // 이미지 업로드 함수
            const uploadImageToImgBB = async (file) => {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = async (e) => {
                        const base64 = e.target.result.split(',')[1];
                        try {
                            const formData = new FormData();
                            formData.append('key', IMGBB_API_KEY);
                            formData.append('image', base64);
                            const response = await fetch('https://api.imgbb.com/1/upload', {
                                method: 'POST',
                                body: formData
                            });
                            const data = await response.json();
                            if (data.success) {
                                resolve(data.data.url);
                            } else {
                                reject(new Error('이미지 업로드 실패'));
                    }
                } catch (error) {
                            reject(error);
                        }
                    };
                    reader.readAsDataURL(file);
                });
            };

            const handleOpenModal = (item = null) => {
                if (item) {
                    setEditingItem(item);
                    setFormData({ 
                        category: item.category, 
                        title: item.title, 
                        content: item.content, 
                        author: item.author, 
                        isSecret: item.isSecret || false, 
                        password: item.password || '',
                        // 인력구인 필드
                        jobDetails: item.jobDetails || '',
                        recruitCount: item.recruitCount || '',
                        workHours: item.workHours || '',
                        salary: item.salary || '',
                        preferred: item.preferred || '',
                        deadline: item.deadline || '',
                        storeLocation: item.storeLocation || '',
                        storePhone: item.storePhone || '',
                        storeImages: item.storeImages || [],
                        // 중고거래 필드
                        itemName: item.itemName || '',
                        itemCategory: item.itemCategory || '',
                        price: item.price || '',
                        itemCondition: item.itemCondition || '',
                        tradeMethod: item.tradeMethod || '',
                        tradeLocation: item.tradeLocation || '',
                        itemImages: item.itemImages || [],
                        businessNumber: item.businessNumber || '',
                        // 프로그램 후기 필드
                        rating: item.rating || 0,
                        reviewImages: item.reviewImages || [],
                        seminarId: item.seminarId || null,
                        seminarTitle: item.seminarTitle || null
                    });
                } else {
                    setEditingItem(null);
                    setFormData({ 
                        category: '공지사항', 
                        title: '', 
                        content: '', 
                        author: currentUser?.name || '관리자', 
                        isSecret: false, 
                        password: '',
                        // 인력구인 필드
                        jobDetails: '',
                        recruitCount: '',
                        workHours: '',
                        salary: '',
                        preferred: '',
                        deadline: '',
                        storeLocation: '',
                        storePhone: '',
                        storeImages: [],
                        // 중고거래 필드
                        itemName: '',
                        itemCategory: '',
                        price: '',
                        itemCondition: '',
                        tradeMethod: '',
                        tradeLocation: '',
                        itemImages: [],
                        businessNumber: '',
                        // 프로그램 후기 필드
                        rating: 0,
                        reviewImages: [],
                        seminarId: null,
                        seminarTitle: null
                    });
                }
                setIsModalOpen(true);
            };
            
            const handleCloseModal = () => {
                setIsModalOpen(false);
                setEditingItem(null);
            };
            
            const handleSubmit = () => {
                if (!formData.title || !formData.content) {
                    alert('제목과 내용은 필수입니다.');
                                        return;
                                    }
                
                if (editingItem) {
                    const updatedPost = {
                        ...formData,
                        id: editingItem.id,
                        date: editingItem.date,
                        views: editingItem.views || 0,
                        likes: editingItem.likes || 0,
                        comments: editingItem.comments || [],
                        reply: editingItem.reply || null,
                        author: formData.author || editingItem.author || currentUser?.name || '관리자'
                    };
                    const updated = posts.map(p => p.id === editingItem.id ? updatedPost : p);
                    setPosts(updated);
                    addLog('UPDATE', '게시글', `${currentUser?.name || '관리자'}님이 게시글을 수정했습니다.`, currentUser?.name, `게시글: ${formData.title}`);
                } else {
                    const newPost = { 
                        ...formData, 
                        id: Date.now(), 
                        date: new Date().toISOString().slice(0, 10).replace(/-/g, '.'), 
                        views: 0, 
                        likes: 0, 
                        comments: [],
                        reply: null,
                        author: formData.author || currentUser?.name || '관리자'
                    };
                    setPosts([newPost, ...posts]);
                    addLog('CREATE', '게시글', `${currentUser?.name || '관리자'}님이 게시글을 추가했습니다.`, currentUser?.name, `게시글: ${formData.title}`);
                }
                handleCloseModal();
            };
            
            const handleDelete = (id) => {
                if (confirm('정말 삭제하시겠습니까?')) {
                    const post = posts.find(p => p.id === id);
                    setPosts(posts.filter(p => p.id !== id));
                    addLog('DELETE', '게시글', `${currentUser?.name || '관리자'}님이 게시글을 삭제했습니다.`, currentUser?.name, `게시글: ${post?.title || ''}`);
                }
            };
                            
                            return (
                            <div>
                    <div className="flex items-center justify-between mb-6">
                        <h2 className="text-2xl font-bold text-dark">커뮤니티 관리</h2>
                        <button onClick={() => handleOpenModal()} className="flex items-center gap-2 px-4 py-2 bg-brand text-white rounded-lg font-bold hover:bg-blue-700 transition-colors">
                            <Icons.Plus size={20} />
                            게시글 추가
                                            </button>
                                    </div>

                    {/* 카테고리 필터 */}
                    <div className="flex gap-2 mb-4 flex-wrap">
                        {categories.map(cat => (
                                            <button
                                key={cat}
                                onClick={() => setSelectedCategory(cat)}
                                className={`px-4 py-2 rounded-lg font-bold text-sm transition-colors ${
                                    selectedCategory === cat ? 'bg-brand text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                                }`}
                            >
                                {cat}
                                            </button>
                                        ))}
                                    </div>
                    
                    <div className="bg-white rounded-2xl border border-gray-200 overflow-hidden">
                        {filteredPosts.length === 0 ? (
                            <div className="p-10 text-center text-gray-400">등록된 게시글이 없습니다.</div>
                        ) : (
                            <table className="w-full">
                                <thead className="bg-gray-50 border-b border-gray-200">
                                    <tr>
                                        <th className="p-4 text-left text-sm font-bold text-gray-700">카테고리</th>
                                        <th className="p-4 text-left text-sm font-bold text-gray-700">제목</th>
                                        <th className="p-4 text-left text-sm font-bold text-gray-700">작성자</th>
                                        <th className="p-4 text-left text-sm font-bold text-gray-700">날짜</th>
                                        <th className="p-4 text-center text-sm font-bold text-gray-700">작업</th>
                                    </tr>
                                </thead>
                                <tbody>
                                        {filteredPosts.map((post, idx) => (
                                        <tr key={post.id || idx} className="border-b border-gray-100 hover:bg-gray-50">
                                            <td className="p-4">
                                                <span className="text-xs px-2 py-1 rounded font-bold bg-blue-100 text-blue-700">{post.category}</span>
                                            </td>
                                            <td className="p-4">
                                                <div className="flex items-center gap-2">
                                                    <span className="font-bold text-dark">{post.title}</span>
                                                    {post.isSecret && <Icons.Lock size={14} className="text-gray-400" />}
                                                    </div>
                                            </td>
                                            <td className="p-4 text-gray-600">{post.author}</td>
                                            <td className="p-4 text-gray-600 text-sm">{post.date}</td>
                                            <td className="p-4">
                                                <div className="flex items-center justify-center gap-2">
                                                    <button onClick={() => handleOpenModal(post)} className="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors">
                                                        <Icons.Edit size={18} />
                                                        </button>
                                                    <button onClick={() => handleDelete(post.id)} className="p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors">
                                                        <Icons.Trash size={18} />
                                                        </button>
                                                    </div>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        )}
                    </div>
                    
                    {/* 모달 */}
                    {isModalOpen && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70" onClick={(e) => e.target === e.currentTarget && handleCloseModal()}>
                            <div className="bg-white rounded-3xl p-8 max-w-3xl w-full max-h-[90vh] overflow-y-auto modal-scroll" onClick={(e) => e.stopPropagation()}>
                                <div className="flex items-center justify-between mb-6">
                                    <h3 className="text-2xl font-bold text-dark">{editingItem ? '게시글 수정' : '게시글 추가'}</h3>
                                    <button onClick={handleCloseModal} className="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                                    <Icons.X size={24} />
                                </button>
                                    </div>
                                
                                <div className="space-y-4">
                                    <div className="grid grid-cols-2 gap-4">
                                                    <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">카테고리</label>
                                            <select className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.category} onChange={(e) => {
                                                const newCategory = e.target.value;
                                                setFormData({
                                                    ...formData,
                                                    category: newCategory,
                                                    // 카테고리 변경 시 관련 필드 초기화
                                                    storeImages: [],
                                                    itemImages: [],
                                                    reviewImages: [],
                                                    businessNumber: '',
                                                    rating: 0
                                                });
                                            }}>
                                                <option value="공지사항">공지사항</option>
                                                <option value="인력구인">인력구인</option>
                                            <option value="프로그램 후기">프로그램 후기</option>
                                            <option value="건의사항">건의사항</option>
                                                <option value="중고거래">중고거래</option>
                                        </select>
                                                    </div>
                                                    <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">작성자</label>
                                            <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.author} onChange={(e) => setFormData({...formData, author: e.target.value})} />
                                                    </div>
                                                    </div>
                                                    <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">제목 *</label>
                                        <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.title} onChange={(e) => setFormData({...formData, title: e.target.value})} />
                                                    </div>
                                                    <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">내용 *</label>
                                        <textarea className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-48 resize-none" value={formData.content} onChange={(e) => setFormData({...formData, content: e.target.value})} />
                                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                                    <div>
                                            <label className="flex items-center gap-2">
                                                <input type="checkbox" checked={formData.isSecret || false} onChange={(e) => setFormData({...formData, isSecret: e.target.checked})} />
                                                <span className="text-sm font-bold text-gray-700">비밀글</span>
                                                        </label>
                                                    </div>
                                    {formData.isSecret && (
                                                    <div>
                                                <label className="block text-sm font-bold text-gray-700 mb-2">비밀번호</label>
                                                <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.password} onChange={(e) => setFormData({...formData, password: e.target.value})} />
                                                    </div>
                                                )}
                                                    </div>

                                {/* 인력구인 추가 필드 */}
                                {formData.category === '인력구인' && (
                                    <>
                                                    <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">업무 내용 *</label>
                                            <textarea className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-32 resize-none" value={formData.jobDetails} onChange={(e) => setFormData({...formData, jobDetails: e.target.value})} placeholder="업무 내용을 상세히 입력해주세요" />
                                                    </div>
                                        <div className="grid grid-cols-2 gap-4">
                                                    <div>
                                                <label className="block text-sm font-bold text-gray-700 mb-2">모집 인원 *</label>
                                                <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.recruitCount} onChange={(e) => setFormData({...formData, recruitCount: e.target.value})} placeholder="명" min="1" />
                                                    </div>
                                                    <div>
                                                <label className="block text-sm font-bold text-gray-700 mb-2">마감일 *</label>
                                                <input type="date" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.deadline} onChange={(e) => setFormData({...formData, deadline: e.target.value})} />
                                                    </div>
                                                    </div>
                                    <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">근무 시간 *</label>
                                            <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.workHours} onChange={(e) => setFormData({...formData, workHours: e.target.value})} placeholder="예: 09:00 ~ 18:00" />
                                    </div>
                                            <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">급여/처우 *</label>
                                            <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.salary} onChange={(e) => setFormData({...formData, salary: e.target.value})} placeholder="예: 월 250만원, 주 5일" />
                                            </div>
                                            <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">우대 사항</label>
                                            <textarea className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-24 resize-none" value={formData.preferred} onChange={(e) => setFormData({...formData, preferred: e.target.value})} placeholder="우대 사항을 입력해주세요" />
                                            </div>
                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <label className="block text-sm font-bold text-gray-700 mb-2">매장 위치 *</label>
                                                <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.storeLocation} onChange={(e) => setFormData({...formData, storeLocation: e.target.value})} placeholder="매장 주소" />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-bold text-gray-700 mb-2">전화번호 *</label>
                                                <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.storePhone} onChange={(e) => setFormData({...formData, storePhone: e.target.value})} placeholder="010-1234-5678" />
                                            </div>
                                            </div>
                                            <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">매장 사진 (최대 3장)</label>
                                            <div className="flex gap-4 flex-wrap">
                                                {formData.storeImages && formData.storeImages.map((img, idx) => (
                                                    <div key={idx} className="relative">
                                                        <img src={img} alt={`매장 사진 ${idx + 1}`} className="w-32 h-32 object-cover rounded-xl border-2 border-gray-200" />
                                                        <button type="button" onClick={() => setFormData({...formData, storeImages: formData.storeImages.filter((_, i) => i !== idx)})} className="absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600">×</button>
                                            </div>
                                                ))}
                                                {(!formData.storeImages || formData.storeImages.length < 3) && (
                                                    <label className="w-32 h-32 border-2 border-dashed border-gray-300 rounded-xl flex items-center justify-center cursor-pointer hover:border-brand transition-colors">
                                                        {uploadingImages ? (
                                                            <div className="text-center">
                                                                <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-brand mx-auto mb-2"></div>
                                                                <span className="text-xs text-gray-500">업로드 중...</span>
                                                </div>
                                                        ) : (
                                                            <div className="text-center">
                                                                <Icons.Plus size={24} className="text-gray-400 mx-auto mb-1" />
                                                                <span className="text-xs text-gray-500">사진 추가</span>
                                            </div>
                                                        )}
                                                        <input type="file" accept="image/*" className="hidden" onChange={async (e) => {
                                                            const files = Array.from(e.target.files);
                                                            if (files.length === 0) return;
                                                            setUploadingImages(true);
                                                            try {
                                                                const uploadedUrls = await Promise.all(files.map(file => uploadImageToImgBB(file)));
                                                                setFormData({...formData, storeImages: [...(formData.storeImages || []), ...uploadedUrls].slice(0, 3)});
                                                            } catch (error) {
                                                                alert('이미지 업로드에 실패했습니다.');
                                                            } finally {
                                                                setUploadingImages(false);
                                                                e.target.value = '';
                                                            }
                                                        }} />
                                                    </label>
                                                )}
                                            </div>
                                            </div>
                                        </>
                                    )}

                                {/* 중고거래 추가 필드 */}
                                    {formData.category === '중고거래' && (
                                        <>
                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <label className="block text-sm font-bold text-gray-700 mb-2">제품명 *</label>
                                                <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.itemName} onChange={(e) => setFormData({...formData, itemName: e.target.value})} placeholder="제품명을 입력해주세요" />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-bold text-gray-700 mb-2">카테고리 *</label>
                                                <select className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.itemCategory} onChange={(e) => setFormData({...formData, itemCategory: e.target.value})}>
                                                    <option value="">카테고리 선택</option>
                                                    <option value="가전제품">가전제품</option>
                                                    <option value="가구">가구</option>
                                                    <option value="의류">의류</option>
                                                    <option value="전자기기">전자기기</option>
                                                    <option value="기타">기타</option>
                                                </select>
                                            </div>
                                            </div>
                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <label className="block text-sm font-bold text-gray-700 mb-2">가격 *</label>
                                                <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.price} onChange={(e) => setFormData({...formData, price: e.target.value})} placeholder="원" min="0" />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-bold text-gray-700 mb-2">상태 *</label>
                                                <select className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.itemCondition} onChange={(e) => setFormData({...formData, itemCondition: e.target.value})}>
                                                    <option value="">상태 선택</option>
                                                    <option value="S급">S급</option>
                                                    <option value="A급">A급</option>
                                                    <option value="B급">B급</option>
                                                    <option value="C급">C급</option>
                                                </select>
                                                </div>
                                            </div>
                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <label className="block text-sm font-bold text-gray-700 mb-2">거래 방식 *</label>
                                                <select className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.tradeMethod} onChange={(e) => setFormData({...formData, tradeMethod: e.target.value})}>
                                                    <option value="">거래 방식 선택</option>
                                                    <option value="직거래">직거래</option>
                                                    <option value="택배">택배</option>
                                                    <option value="직거래/택배">직거래/택배</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label className="block text-sm font-bold text-gray-700 mb-2">거래 지역 *</label>
                                                <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.tradeLocation} onChange={(e) => setFormData({...formData, tradeLocation: e.target.value})} placeholder="거래 지역을 입력해주세요" />
                                                    </div>
                                                </div>
                                        <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">제품 사진 (최대 3장)</label>
                                            <div className="flex gap-4 flex-wrap">
                                                {formData.itemImages && formData.itemImages.map((img, idx) => (
                                                            <div key={idx} className="relative">
                                                        <img src={img} alt={`제품 사진 ${idx + 1}`} className="w-32 h-32 object-cover rounded-xl border-2 border-gray-200" />
                                                        <button type="button" onClick={() => setFormData({...formData, itemImages: formData.itemImages.filter((_, i) => i !== idx)})} className="absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600">×</button>
                                                            </div>
                                                        ))}
                                                {(!formData.itemImages || formData.itemImages.length < 3) && (
                                                    <label className="w-32 h-32 border-2 border-dashed border-gray-300 rounded-xl flex items-center justify-center cursor-pointer hover:border-brand transition-colors">
                                                        {uploadingImages ? (
                                                            <div className="text-center">
                                                                <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-brand mx-auto mb-2"></div>
                                                                <span className="text-xs text-gray-500">업로드 중...</span>
                                                    </div>
                                                        ) : (
                                                            <div className="text-center">
                                                                <Icons.Plus size={24} className="text-gray-400 mx-auto mb-1" />
                                                                <span className="text-xs text-gray-500">사진 추가</span>
                                            </div>
                                                        )}
                                                        <input type="file" accept="image/*" className="hidden" onChange={async (e) => {
                                                            const files = Array.from(e.target.files);
                                                            if (files.length === 0) return;
                                                            setUploadingImages(true);
                                                            try {
                                                                const uploadedUrls = await Promise.all(files.map(file => uploadImageToImgBB(file)));
                                                                setFormData({...formData, itemImages: [...(formData.itemImages || []), ...uploadedUrls].slice(0, 3)});
                                                            } catch (error) {
                                                                alert('이미지 업로드에 실패했습니다.');
                                                            } finally {
                                                                setUploadingImages(false);
                                                                e.target.value = '';
                                                            }
                                                        }} />
                                                    </label>
                                                )}
                                            </div>
                                    </div>
                                    <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">사업자등록번호 * (신뢰도 확인용)</label>
                                            <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={formData.businessNumber} onChange={(e) => setFormData({...formData, businessNumber: e.target.value})} placeholder="사업자등록번호를 입력해주세요" />
                                    </div>
                                        </>
                                    )}

                                {/* 프로그램 후기 추가 필드 */}
                                    {formData.category === '프로그램 후기' && (
                                        <>
                                            <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">별점 *</label>
                                                <div className="flex gap-2">
                                                    {[1, 2, 3, 4, 5].map(star => (
                                                    <button
                                                        key={star}
                                                        type="button"
                                                        onClick={() => setFormData({...formData, rating: star})}
                                                        className="focus:outline-none"
                                                    >
                                                        <svg className={`w-8 h-8 transition-colors ${formData.rating >= star ? 'text-yellow-400' : 'text-gray-300'}`} fill={formData.rating >= star ? 'currentColor' : 'none'} stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                                                        </svg>
                                                        </button>
                                                    ))}
                                                </div>
                                            {formData.rating > 0 && (
                                                <p className="text-xs text-gray-500 mt-1">{formData.rating}점 선택됨</p>
                                            )}
                                            </div>
                                            <div>
                                            <label className="block text-sm font-bold text-gray-700 mb-2">후기 사진 (최대 3장)</label>
                                            <div className="flex gap-4 flex-wrap">
                                                {formData.reviewImages && formData.reviewImages.map((img, idx) => (
                                                    <div key={idx} className="relative">
                                                        <img src={img} alt={`후기 사진 ${idx + 1}`} className="w-32 h-32 object-cover rounded-xl border-2 border-gray-200" />
                                                        <button type="button" onClick={() => setFormData({...formData, reviewImages: formData.reviewImages.filter((_, i) => i !== idx)})} className="absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600">×</button>
                                                    </div>
                                                ))}
                                                {(!formData.reviewImages || formData.reviewImages.length < 3) && (
                                                    <label className="w-32 h-32 border-2 border-dashed border-gray-300 rounded-xl flex items-center justify-center cursor-pointer hover:border-brand transition-colors">
                                                        {uploadingImages ? (
                                                            <div className="text-center">
                                                                <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-brand mx-auto mb-2"></div>
                                                                <span className="text-xs text-gray-500">업로드 중...</span>
                                                            </div>
                                                                ) : (
                                                            <div className="text-center">
                                                                <Icons.Plus size={24} className="text-gray-400 mx-auto mb-1" />
                                                                <span className="text-xs text-gray-500">사진 추가</span>
                                                            </div>
                                                        )}
                                                        <input type="file" accept="image/*" className="hidden" onChange={async (e) => {
                                                            const files = Array.from(e.target.files);
                                                            if (files.length === 0) return;
                                                            setUploadingImages(true);
                                                            try {
                                                                const uploadedUrls = await Promise.all(files.map(file => uploadImageToImgBB(file)));
                                                                setFormData({...formData, reviewImages: [...(formData.reviewImages || []), ...uploadedUrls].slice(0, 3)});
                                                            } catch (error) {
                                                                alert('이미지 업로드에 실패했습니다.');
                                                            } finally {
                                                                setUploadingImages(false);
                                                                                        e.target.value = '';
                                                                                    }
                                                        }} />
                                                                        </label>
                                                )}
                                                            </div>
                                            </div>
                                        </>
                                    )}
                                    </div>
                                
                                <div className="flex gap-4 mt-8">
                                    <button onClick={handleCloseModal} className="flex-1 py-4 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition-colors">
                                        취소
                                    </button>
                                    <button onClick={handleSubmit} className="flex-1 py-4 bg-brand text-white font-bold rounded-xl hover:bg-blue-700 transition-colors">
                                        {editingItem ? '수정' : '추가'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                            </div>
            );
        };

        // ==========================================
        // MasterTab 하위 컴포넌트들
        // ==========================================
        const MasterTabHeader = ({ masterSubTab, setMasterSubTab }) => {
            return (
                <div className="mb-6">
                    <h2 className="text-2xl font-bold text-dark mb-4">admin</h2>
                    <div className="flex gap-2 border-b border-gray-200">
                        <button
                            onClick={() => setMasterSubTab('logs')}
                            className={`px-4 py-2 font-bold text-sm transition-colors border-b-2 ${
                                masterSubTab === 'logs' ? 'border-brand text-brand' : 'border-transparent text-gray-400 hover:text-gray-600'
                            }`}
                        >
                            활동 기록
                                </button>
                                <button
                            onClick={() => setMasterSubTab('content')}
                            className={`px-4 py-2 font-bold text-sm transition-colors border-b-2 ${
                                masterSubTab === 'content' ? 'border-brand text-brand' : 'border-transparent text-gray-400 hover:text-gray-600'
                            }`}
                        >
                            페이지 관리
                                </button>
                                <button
                            onClick={() => setMasterSubTab('csv')}
                            className={`px-4 py-2 font-bold text-sm transition-colors border-b-2 ${
                                masterSubTab === 'csv' ? 'border-brand text-brand' : 'border-transparent text-gray-400 hover:text-gray-600'
                            }`}
                        >
                            CSV 관리
                                </button>
                            </div>
                        </div>
            );
        };

        const LogsView = ({ logs }) => {
            return (
                <div className="bg-gray-50 rounded-2xl p-6">
                    <h3 className="font-bold text-dark mb-4 flex items-center gap-2">
                        <Icons.List className="text-brand" />
                        관리자 활동 기록
                        <span className="text-xs bg-red-100 text-red-600 px-2 py-1 rounded font-bold">Master Only</span>
                    </h3>
                    <div className="overflow-x-auto">
                        <table className="w-full text-left">
                            <thead className="bg-gray-100 text-xs text-gray-500">
                                <tr>
                                    <th className="p-4">일시</th>
                                    <th className="p-4">관리자</th>
                                    <th className="p-4">작업</th>
                                    <th className="p-4">대상</th>
                                    <th className="p-4">상세 내용</th>
                                </tr>
                            </thead>
                            <tbody>
                                {logs.length > 0 ? (
                                    logs.slice().reverse().map((log, idx) => (
                                        <tr key={idx} className="border-b border-gray-50 hover:bg-gray-50">
                                            <td className="p-4 text-xs text-gray-500">{log.timestamp}</td>
                                            <td className="p-4">
                                                <span className="text-xs font-bold text-brand bg-brand/10 px-2 py-1 rounded">
                                                    {log.adminName || '시스템'}
                                            </span>
                                            </td>
                                            <td className="p-4">
                                                <span className={`text-xs px-2 py-1 rounded font-bold ${
                                                    log.action === 'CREATE' ? 'bg-green-100 text-green-700' :
                                                    log.action === 'UPDATE' ? 'bg-blue-100 text-blue-700' :
                                                    'bg-red-100 text-red-700'
                                                }`}>
                                                    {log.action}
                                                    </span>
                                            </td>
                                            <td className="p-4 text-sm font-bold text-gray-700">{log.targetType}</td>
                                            <td className="p-4 text-sm text-gray-600">{log.details}</td>
                                        </tr>
                                    ))
                                ) : (
                                    <tr>
                                        <td colSpan="5" className="p-10 text-center text-gray-400">기록된 활동이 없습니다.</td>
                                    </tr>
                                )}
                            </tbody>
                        </table>
                                    </div>
                </div>
            );
        };

        const ContentView = ({ content, setContent, menuEnabled, setMenuEnabled, menuNames, setMenuNames, addLog, currentUser }) => {
            const handleSave = () => {
                saveDataToStorage(STORAGE_KEY_CONTENT, content);
                saveDataToStorage(STORAGE_KEY_MENU_ENABLED, menuEnabled);
                saveDataToStorage(STORAGE_KEY_MENU_NAMES, menuNames);
                addLog('UPDATE', '페이지 설정', `${currentUser?.name || '관리자'}님이 페이지 설정을 변경했습니다.`, currentUser?.name);
                alert('페이지 설정이 저장되었습니다.');
            };

            const handleReset = () => {
                if (!confirm('모든 페이지 설정을 초기화하시겠습니까? 이 작업은 되돌릴 수 없습니다.')) {
                    return;
                }
                const defaultMenuEnabled = {
                    '홈': true,
                    '소개': true,
                    '프로그램': true,
                    '부청사 회원': true,
                    '커뮤니티': true,
                    '입찰공고': true,
                    '후원': true
                };
                const defaultMenuNames = {
                    '홈': '홈',
                    '소개': '소개',
                    '프로그램': '프로그램',
                    '부청사 회원': '부청사 회원',
                    '커뮤니티': '커뮤니티',
                    '입찰공고': '입찰공고',
                    '후원': '후원'
                };
                setContent(defaultContent);
                setMenuEnabled(defaultMenuEnabled);
                setMenuNames(defaultMenuNames);
                saveDataToStorage(STORAGE_KEY_CONTENT, defaultContent);
                saveDataToStorage(STORAGE_KEY_MENU_ENABLED, defaultMenuEnabled);
                saveDataToStorage(STORAGE_KEY_MENU_NAMES, defaultMenuNames);
                addLog('RESET', '페이지 설정', `${currentUser?.name || '관리자'}님이 페이지 설정을 초기화했습니다.`, currentUser?.name);
                alert('페이지 설정이 초기화되었습니다.');
            };

            return (
                <div className="bg-gray-50 rounded-2xl p-6">
                    <h3 className="font-bold text-dark mb-4">페이지 관리</h3>
                    <div className="space-y-6">
                        <div>
                            <label className="block text-sm font-bold text-gray-700 mb-2">히어로 타이틀</label>
                            <textarea 
                                className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-24 resize-none"
                                value={content.hero_title || ''}
                                onChange={(e) => setContent({...content, hero_title: e.target.value})}
                                />
                            </div>
                        <div>
                            <label className="block text-sm font-bold text-gray-700 mb-2">히어로 설명</label>
                            <textarea 
                                className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-24 resize-none"
                                value={content.hero_desc || ''}
                                onChange={(e) => setContent({...content, hero_desc: e.target.value})}
                            />
                            </div>

                        {/* 소개 페이지 필드 */}
                        <div className="pt-4 border-t border-gray-200">
                            <h4 className="font-bold text-dark mb-4">소개 페이지</h4>
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">소개 페이지 히어로 타이틀</label>
                                    <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={content.about_hero_title || ''} onChange={(e) => setContent({...content, about_hero_title: e.target.value})} />
                                    </div>
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">소개 페이지 히어로 설명</label>
                                    <textarea className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-24 resize-none" value={content.about_hero_desc || ''} onChange={(e) => setContent({...content, about_hero_desc: e.target.value})} />
                                </div>
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">미션 타이틀</label>
                                    <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={content.about_mission_title || ''} onChange={(e) => setContent({...content, about_mission_title: e.target.value})} />
                                            </div>
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">미션 설명 1</label>
                                    <textarea className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-20 resize-none" value={content.about_mission_desc_1 || ''} onChange={(e) => setContent({...content, about_mission_desc_1: e.target.value})} />
                                    </div>
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">미션 설명 2</label>
                                    <textarea className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-20 resize-none" value={content.about_mission_desc_2 || ''} onChange={(e) => setContent({...content, about_mission_desc_2: e.target.value})} />
                                </div>
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">미션 설명 3</label>
                                    <textarea className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-20 resize-none" value={content.about_mission_desc_3 || ''} onChange={(e) => setContent({...content, about_mission_desc_3: e.target.value})} />
                            </div>
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">필요한 이유 타이틀</label>
                                    <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={content.about_why_title || ''} onChange={(e) => setContent({...content, about_why_title: e.target.value})} />
                            </div>
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">필요한 이유 부제목</label>
                                    <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={content.about_why_subtitle || ''} onChange={(e) => setContent({...content, about_why_subtitle: e.target.value})} />
                            </div>
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">이유 1 타이틀</label>
                                        <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={content.about_why_1_title || ''} onChange={(e) => setContent({...content, about_why_1_title: e.target.value})} />
                                        </div>
                                    <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">이유 1 설명</label>
                                        <textarea className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-20 resize-none" value={content.about_why_1_desc || ''} onChange={(e) => setContent({...content, about_why_1_desc: e.target.value})} />
                                    </div>
                            </div>
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">이유 2 타이틀</label>
                                        <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={content.about_why_2_title || ''} onChange={(e) => setContent({...content, about_why_2_title: e.target.value})} />
                            </div>
                                    <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">이유 2 설명</label>
                                        <textarea className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-20 resize-none" value={content.about_why_2_desc || ''} onChange={(e) => setContent({...content, about_why_2_desc: e.target.value})} />
                                                    </div>
                                                </div>
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">이유 3 타이틀</label>
                                        <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={content.about_why_3_title || ''} onChange={(e) => setContent({...content, about_why_3_title: e.target.value})} />
                                        </div>
                                    <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">이유 3 설명</label>
                                        <textarea className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-20 resize-none" value={content.about_why_3_desc || ''} onChange={(e) => setContent({...content, about_why_3_desc: e.target.value})} />
                                </div>
                            </div>
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">이유 4 타이틀</label>
                                        <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={content.about_why_4_title || ''} onChange={(e) => setContent({...content, about_why_4_title: e.target.value})} />
                                            </div>
                                    <div>
                                        <label className="block text-sm font-bold text-gray-700 mb-2">이유 4 설명</label>
                                        <textarea className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none h-20 resize-none" value={content.about_why_4_desc || ''} onChange={(e) => setContent({...content, about_why_4_desc: e.target.value})} />
                                    </div>
                            </div>
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">연락처 전화번호</label>
                                    <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={content.about_contact_phone || ''} onChange={(e) => setContent({...content, about_contact_phone: e.target.value})} />
                            </div>
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">연락처 이메일</label>
                                    <input type="email" className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none" value={content.about_contact_email || ''} onChange={(e) => setContent({...content, about_contact_email: e.target.value})} />
                                </div>
                            </div>
                                    </div>
                        
                        <div className="pt-4 border-t border-gray-200">
                            <h4 className="font-bold text-dark mb-4">메뉴 활성화</h4>
                            <div className="space-y-3">
                                {['홈', '소개', '프로그램', '부청사 회원', '커뮤니티', '입찰공고', '후원'].map(menu => (
                                    <div key={menu} className="flex items-center justify-between p-3 bg-white rounded-lg">
                                        <span className="font-bold text-gray-700">{menu}</span>
                                        <label className="flex items-center gap-2">
                                            <input 
                                                type="checkbox" 
                                                checked={menuEnabled[menu] !== undefined ? menuEnabled[menu] : true}
                                                onChange={(e) => setMenuEnabled({...menuEnabled, [menu]: e.target.checked})}
                                            />
                                            <span className="text-sm text-gray-600">활성화</span>
                                        </label>
                                </div>
                                    ))}
                            </div>
                    </div>
                        
                        <div className="pt-4 border-t border-gray-200">
                            <h4 className="font-bold text-dark mb-4">메뉴 이름 변경</h4>
                            <div className="space-y-3">
                                {['홈', '소개', '프로그램', '부청사 회원', '커뮤니티', '입찰공고', '후원'].map(menu => (
                                    <div key={menu} className="flex items-center gap-3">
                                        <span className="w-32 text-sm font-bold text-gray-700">{menu}:</span>
                                        <input 
                                            type="text"
                                            className="flex-1 p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none"
                                            value={menuNames[menu] || menu}
                                            onChange={(e) => setMenuNames({...menuNames, [menu]: e.target.value})}
                                            placeholder={menu}
                                        />
                </div>
                                ))}
                            </div>
                        </div>

                        <div className="flex gap-4">
                                    <button
                                onClick={handleReset}
                                className="flex-1 py-4 bg-red-500 text-white font-bold rounded-xl hover:bg-red-600 transition-colors"
                            >
                                초기화
                                    </button>
                                    <button
                                onClick={handleSave}
                                className="flex-1 py-4 bg-brand text-white font-bold rounded-xl hover:bg-blue-700 transition-colors"
                            >
                                저장
                                    </button>
                                </div>
                            </div>
                                </div>
            );
        };

        const CsvView = ({ csvUrls, setCsvUrls, handleSaveCsvUrls }) => {
            return (
                <div className="bg-gray-50 rounded-2xl p-6">
                    <h3 className="font-bold text-dark mb-4">CSV 관리</h3>
                    <div className="space-y-4">
                            <div>
                            <label className="block text-sm font-bold text-gray-700 mb-2">회원 CSV URL</label>
                                    <input
                                type="text"
                                className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none"
                                value={csvUrls.members || ''}
                                onChange={(e) => setCsvUrls({...csvUrls, members: e.target.value})}
                                placeholder="https://docs.google.com/spreadsheets/..."
                            />
                                </div>
                                    <div>
                            <label className="block text-sm font-bold text-gray-700 mb-2">프로그램 CSV URL</label>
                                        <input
                                            type="text"
                                className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none"
                                value={csvUrls.seminars || ''}
                                onChange={(e) => setCsvUrls({...csvUrls, seminars: e.target.value})}
                                placeholder="https://docs.google.com/spreadsheets/..."
                                        />
                                    </div>
                        <div>
                            <label className="block text-sm font-bold text-gray-700 mb-2">게시글 CSV URL</label>
                                        <input
                                type="text"
                                className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-brand focus:outline-none"
                                value={csvUrls.posts || ''}
                                onChange={(e) => setCsvUrls({...csvUrls, posts: e.target.value})}
                                placeholder="https://docs.google.com/spreadsheets/..."
                            />
                            </div>

                                <button
                            onClick={handleSaveCsvUrls}
                            className="w-full py-4 bg-brand text-white font-bold rounded-xl hover:bg-blue-700 transition-colors"
                        >
                            CSV URL 저장
                                </button>
                        
                        <div className="mt-8 pt-6 border-t border-gray-200">
                            <h4 className="font-bold text-dark mb-4">CSV 형식 가이드</h4>
                            <div className="bg-white rounded-xl p-4 space-y-4 text-sm">
                                <div>
                                    <p className="font-bold text-gray-700 mb-2">회원 CSV 컬럼:</p>
                                    <p className="text-gray-600">이름, 업종, 직책, 회사명, 이미지URL</p>
                            </div>
                                <div>
                                    <p className="font-bold text-gray-700 mb-2">프로그램 CSV 컬럼:</p>
                                    <p className="text-gray-600">제목, 날짜(YYYY.MM.DD), 장소, 설명, 이미지URL, 상태, 카테고리, 현재인원, 최대인원</p>
                        </div>
                                <div>
                                    <p className="font-bold text-gray-700 mb-2">게시글 CSV 컬럼:</p>
                                    <p className="text-gray-600">카테고리, 제목, 작성자, 날짜(YYYY.MM.DD), 내용, 비밀글여부(true/false), 비밀번호, 조회수, 좋아요수</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const MasterTab = ({ content, setContent, menuEnabled, setMenuEnabled, menuNames, setMenuNames, logs, addLog, currentUser }) => {
            const [masterSubTab, setMasterSubTab] = useState('logs');
            const [csvUrls, setCsvUrls] = useState(() => loadDataFromStorage(STORAGE_KEY_CSV_URLS, { members: '', seminars: '', posts: '' }));
            
            const handleSaveCsvUrls = () => {
                saveDataToStorage(STORAGE_KEY_CSV_URLS, csvUrls);
                addLog('UPDATE', 'CSV URL', `${currentUser?.name || '관리자'}님이 CSV URL을 수정했습니다.`, currentUser?.name);
                alert('CSV URL이 저장되었습니다.');
            };

            // 컨텐츠 렌더링 함수
            const renderContent = () => {
                switch(masterSubTab) {
                    case 'logs':
                        return <LogsView logs={logs} />;
                    case 'content':
                        return (
                            <ContentView 
                                content={content}
                                setContent={setContent}
                                menuEnabled={menuEnabled}
                                setMenuEnabled={setMenuEnabled}
                                menuNames={menuNames}
                                setMenuNames={setMenuNames}
                                addLog={addLog}
                                currentUser={currentUser}
                            />
                        );
                    case 'csv':
                        return (
                            <CsvView 
                                csvUrls={csvUrls}
                                setCsvUrls={setCsvUrls}
                                handleSaveCsvUrls={handleSaveCsvUrls}
                            />
                        );
                    default:
                        return null;
                }
            };

            return (
                                        <div>
                    <MasterTabHeader masterSubTab={masterSubTab} setMasterSubTab={setMasterSubTab} />
                    {renderContent()}
                </div>
            );
        };

        // ==========================================
        // App 컴포넌트
        // ==========================================
        const App = () => {
            return <AdminDashboard />;
        };

        // 렌더링
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
